{"version":3,"file":"default-src_app_core_services_group_service_ts.js","mappings":"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","sources":["./src/app/core/services/group.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport { Observable, of, BehaviorSubject } from 'rxjs';\nimport { AuthService } from './auth.service';\n\ninterface GroupMember {\n  id: string;\n  name: string;\n  email: string;\n  joinedAt: Date;\n  status: 'active' | 'inactive';\n  role: 'admin' | 'player';\n}\n\ninterface GroupSettings {\n  allowPlayerInvites: boolean;\n  autoApproveJoins: boolean;\n  showLeaderboard: boolean;\n  allowMemberChat: boolean;\n}\n\ninterface GroupLeaderboardEntry {\n  position: number;\n  name: string;\n  played: number;\n  points: number;\n  totalPoints: number;\n  jokerUsed: number;\n  memberId: string;\n  memberName: string;\n  rank: number;\n  trend: 'up' | 'down' | 'same';\n}\n\n// Standardized Standing interface for compatibility\nexport interface Standing {\n  position: number;\n  previousPosition: number;\n  userId: string;\n  name: string;\n  avatar?: string;\n  played: number;\n  points: number;\n  correctScores: number;\n  correctResults: number;\n  jokerUsed: number;\n}\n\ninterface Group {\n  id: string;\n  name: string;\n  code: string;\n  memberCount: number;\n  createdAt: Date;\n  members: GroupMember[];\n  settings: GroupSettings;\n  type: 'casual' | 'prize';\n  entryFee?: number;\n  paidMembers: number;\n  totalPrizePool?: number;\n  adminName: string;\n  leaderboard: GroupLeaderboardEntry[];\n}\n\ninterface CreateGroupDto {\n  name: string;\n  description: string;\n  entryFee: number;\n  isPrivate: boolean;\n}\n\n// Standardized group with standings interface\nexport interface GroupWithStandings {\n  group: {\n    id: string;\n    name: string;\n    code: string;\n    memberCount: number;\n    type: 'casual' | 'prize';\n  };\n  leaderboard: Standing[];\n  userPosition: number | null;\n}\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class GroupService {\n  private readonly STORAGE_KEY_PREFIX = 'sotd_groups';\n  private readonly USER_GROUPS_KEY_PREFIX = 'sotd_user_groups'; // Legacy - for future use\n  private readonly LEGACY_STORAGE_KEY = 'sotd_groups'; // For migration\n  // Add global storage key for all groups\n  private readonly GLOBAL_GROUPS_KEY = 'sotd_all_groups';\n  \n  private groupsSubject = new BehaviorSubject<Group[]>([]);\n  public groups$ = this.groupsSubject.asObservable();\n\n  constructor(private authService: AuthService) {\n\n    \n    // Initialize global storage\n    this.initializeGlobalStorage();\n    \n    // Subscribe to auth changes\n    this.authService.currentUser.subscribe((authResponse: any) => {\n\n      this.handleUserChange(authResponse?.user || null);\n    });\n  }\n\n  private handleUserChange(user: any | null): void {\n\n    if (user) {\n\n      this.loadGroups();\n    } else {\n\n      this.groupsSubject.next([]);\n    }\n  }\n\n  /**\n   * Reinitialize storage for current user (useful when user logs in)\n   */\n  public reinitializeForCurrentUser(): void {\n\n    this.initializeGlobalStorage();\n    this.loadGroups();\n  }\n\n  /**\n   * Initialize global storage for all groups\n   */\n  private initializeGlobalStorage(): void {\n    const globalData = localStorage.getItem(this.GLOBAL_GROUPS_KEY);\n    const legacyData = localStorage.getItem(this.LEGACY_STORAGE_KEY);\n\n\n\n\n\n    // If no global data but legacy data exists, migrate it\n    if (!globalData && legacyData) {\n\n      \n      try {\n        const legacyGroups = JSON.parse(legacyData);\n\n        localStorage.setItem(this.GLOBAL_GROUPS_KEY, JSON.stringify(legacyGroups));\n      } catch (error) {\n        console.error('❌ GroupService: Error migrating legacy data:', error);\n        localStorage.setItem(this.GLOBAL_GROUPS_KEY, JSON.stringify([]));\n      }\n    } else if (!globalData) {\n      // Initialize empty array for new installation\n\n      localStorage.setItem(this.GLOBAL_GROUPS_KEY, JSON.stringify([]));\n    }\n  }\n\n  /**\n   * Generate user-specific storage key (kept for future user preferences)\n   * Falls back to legacy key if no user is authenticated\n   */\n  private getUserSpecificStorageKey(): string {\n    const currentUser = this.authService.getCurrentUser();\n    \n    if (!currentUser?.id) {\n\n      return this.LEGACY_STORAGE_KEY;\n    }\n    \n    const userSpecificKey = `${this.STORAGE_KEY_PREFIX}_${currentUser.id}`;\n\n    return userSpecificKey;\n  }\n\n  /**\n   * Clear group data for current user (useful for logout cleanup)\n   */\n  public clearUserGroupData(): void {\n    const currentUser = this.authService.getCurrentUser();\n    \n    if (!currentUser?.id) {\n\n      return;\n    }\n\n    // Note: We don't clear global groups on logout, only user-specific data\n\n    \n    // Clear the observable\n    this.groupsSubject.next([]);\n  }\n\n  private loadGroups(): void {\n    const groups = this.getAllGroups();\n    this.groupsSubject.next(groups);\n  }\n\n  getAllGroups(): Group[] {\n    const groupsJson = localStorage.getItem(this.GLOBAL_GROUPS_KEY);\n    \n    if (!groupsJson) {\n\n      return [];\n    }\n\n    try {\n      const groups = JSON.parse(groupsJson);\n\n      \n      return groups.map((group: any) => ({\n        ...group,\n        createdAt: new Date(group.createdAt),\n        members: group.members.map((member: any) => ({\n          ...member,\n          joinedAt: new Date(member.joinedAt),\n        })),\n      }));\n    } catch (error) {\n      console.error('❌ GroupService: Error parsing group data:', error);\n      return [];\n    }\n  }\n\n  // Get groups that the current user is a member of\n  getUserGroups(): Group[] {\n    const currentUser = this.authService.getCurrentUser();\n    if (!currentUser?.email) {\n\n      return [];\n    }\n\n    const allGroups = this.getAllGroups();\n    const userGroups = allGroups.filter(group => \n      group.members.some((member: GroupMember) => member.email === currentUser.email)\n    );\n\n\n    return userGroups;\n  }\n\n  // Get groups created by the current user (group admin)\n  getAdminGroups(): Group[] {\n    const currentUser = this.authService.getCurrentUser();\n    \n    if (!currentUser?.email) {\n\n      return [];\n    }\n\n    const allGroups = this.getAllGroups();\n    const adminGroups = allGroups.filter(group => \n      group.members.some((member: GroupMember) => \n        member.email === currentUser.email && member.role === 'admin'\n      )\n    );\n\n\n    return adminGroups;\n  }\n\n  saveGroup(group: any): void {\n    const currentUser = this.authService.getCurrentUser();\n    \n    if (!currentUser?.id) {\n      console.error('❌ GroupService: Cannot save group - no authenticated user');\n      throw new Error('User not authenticated');\n    }\n\n    const groups = this.getAllGroups();\n    const existingIndex = groups.findIndex((g) => g.id === group.id);\n\n    if (existingIndex >= 0) {\n\n      groups[existingIndex] = group;\n    } else {\n\n      groups.push(group);\n    }\n\n    // Save to global storage instead of user-specific\n    localStorage.setItem(this.GLOBAL_GROUPS_KEY, JSON.stringify(groups));\n\n    \n    // Trigger real-time updates\n    this.loadGroups();\n  }\n\n  findGroupByCode(code: string): Group | null {\n\n    const groups = this.getAllGroups();\n\n\n    \n    const group = groups.find((g) => g.code === code);\n\n    \n    return group || null;\n  }\n\n  joinGroup(groupCode: string, customMember?: GroupMember): Group | null {\n\n    \n    const currentUser = this.authService.getCurrentUser();\n\n\n\n    \n    // Debug: Show detailed user information\n\n\n\n\n    \n    if (!currentUser) {\n\n      throw new Error('User not authenticated');\n    }\n\n    const groups = this.getAllGroups();\n\n    \n    const groupIndex = groups.findIndex((g) => g.code === groupCode);\n\n\n    if (groupIndex === -1) {\n\n      return null;\n    }\n\n    const group = groups[groupIndex];\n\n\n\n\n    // Enhanced debugging for member matching\n\n    group.members.forEach((member, index) => {\n\n\n\n\n\n\n    });\n\n    // Check if user already exists in this group\n    // Use both ID and email for comprehensive checking, but prioritize ID for accuracy\n    const existingMemberById = group.members.find((m: GroupMember) => m.id === currentUser.id);\n    const existingMemberByEmail = group.members.find((m: GroupMember) => m.email === currentUser.email);\n\n\n    \n    // If found by ID (most accurate), use that\n    const existingMember = existingMemberById || existingMemberByEmail;\n    \n    if (existingMember) {\n\n\n\n\n\n\n\n      \n      // If user is already an admin, they can't join as a player\n      if (existingMember.role === 'admin') {\n        throw new Error('You are the admin of this group and cannot join as a player');\n      }\n      // If user is already a player member\n      if (existingMember.role === 'player') {\n        throw new Error('You are already a member of this group');\n      }\n    }\n\n    // Create member from current user data or use custom member\n    const member: GroupMember = customMember || {\n      id: currentUser.id,\n      name: currentUser.firstName && currentUser.lastName \n        ? `${currentUser.firstName} ${currentUser.lastName}`\n        : currentUser.username,\n      email: currentUser.email || '',\n      joinedAt: new Date(),\n      status: 'active',\n      role: 'player'\n    };\n\n\n\n    // Add member to group\n    group.members.push(member);\n    group.memberCount = group.members.length;\n\n\n    // Clear existing leaderboard to force regeneration with new member\n    group.leaderboard = [];\n\n    // Update storage and trigger updates\n    groups[groupIndex] = group;\n    localStorage.setItem(this.GLOBAL_GROUPS_KEY, JSON.stringify(groups));\n    this.loadGroups();\n\n\n    return group;\n  }\n\n  deleteGroup(groupId: string): void {\n    const groups = this.getAllGroups().filter((g) => g.id !== groupId);\n    localStorage.setItem(this.GLOBAL_GROUPS_KEY, JSON.stringify(groups));\n    this.loadGroups();\n  }\n\n  createGroup(data: CreateGroupDto): Observable<Group> {\n    const currentUser = this.authService.getCurrentUser();\n    if (!currentUser) throw new Error('User not authenticated');\n\n    // Create admin member from current user\n    const adminMember: GroupMember = {\n      id: currentUser.id,\n      name: currentUser.firstName && currentUser.lastName \n        ? `${currentUser.firstName} ${currentUser.lastName}`\n        : currentUser.username,\n      email: currentUser.email || '',\n      joinedAt: new Date(),\n      status: 'active',\n      role: 'admin'\n    };\n\n    const newGroup: Group = {\n      id: crypto.randomUUID(),\n      name: data.name,\n      code: this.generateGroupCode(),\n      memberCount: 1,\n      createdAt: new Date(),\n      members: [adminMember], // Add the creator as admin\n      settings: {\n        allowPlayerInvites: true,\n        autoApproveJoins: false,\n        showLeaderboard: true,\n        allowMemberChat: true,\n      },\n      type: data.entryFee > 0 ? 'prize' : 'casual',\n      entryFee: data.entryFee,\n      paidMembers: 0,\n      totalPrizePool: 0,\n      adminName: adminMember.name,\n      leaderboard: [],\n    };\n\n\n\n\n    \n    this.saveGroup(newGroup);\n    \n    // Verify group was saved\n    const savedGroups = this.getAllGroups();\n\n\n    \n    return of(newGroup);\n  }\n\n  // Get leaderboard for a specific group\n  getGroupLeaderboard(groupId: string): GroupLeaderboardEntry[] {\n    const group = this.getAllGroups().find(g => g.id === groupId);\n    if (!group) return [];\n\n    // If no leaderboard exists, generate mock data for members\n    if (group.leaderboard.length === 0) {\n      const mockLeaderboard = this.generateMockLeaderboard(group);\n      // Update the group with the generated leaderboard\n      group.leaderboard = mockLeaderboard;\n      this.saveGroup(group);\n      return mockLeaderboard;\n    }\n\n    return group.leaderboard;\n  }\n\n  // Generate mock leaderboard data for testing with better distribution\n  private generateMockLeaderboard(group: Group): GroupLeaderboardEntry[] {\n    const currentUser = this.authService.getCurrentUser();\n    \n    // More realistic point distribution\n    const basePoints = 180 + Math.floor(Math.random() * 40); // 180-220 base range\n    const pointsVariation = Math.floor(Math.random() * 30) + 10; // 10-40 variation\n    \n    return group.members.map((member: GroupMember, index: number) => {\n      const pointVariation = Math.floor(Math.random() * pointsVariation) - (pointsVariation / 2);\n      const memberPoints = Math.max(0, basePoints - (index * 15) + pointVariation);\n      \n      return {\n        position: index + 1,\n        memberId: member.id,\n        memberName: member.id === currentUser?.id ? 'You' : member.name,\n        name: member.id === currentUser?.id ? 'You' : member.name,\n        played: Math.floor(Math.random() * 8) + 12, // 12-20 games played\n        points: memberPoints,\n        totalPoints: memberPoints, // Same as points for compatibility\n        jokerUsed: Math.floor(Math.random() * 3) + 1, // 1-3 jokers used\n        rank: index + 1,\n        trend: index === 0 ? 'same' as const : \n               Math.random() > 0.7 ? 'up' as const : \n               Math.random() > 0.5 ? 'down' as const : 'same' as const,\n      };\n    }).sort((a: any, b: any) => b.points - a.points) // Sort by points descending\n      .map((entry: any, index: number) => ({ \n        ...entry, \n        position: index + 1, \n        rank: index + 1 \n      })); // Update positions after sorting\n  }\n\n  // Centralized conversion function to maintain consistency\n  convertToStandings(entries: GroupLeaderboardEntry[]): Standing[] {\n    return entries.map(entry => ({\n      position: entry.position,\n      previousPosition: entry.position, // Use same as position for now\n      userId: entry.memberId,\n      name: entry.name,\n      played: entry.played,\n      points: entry.points,\n      correctScores: Math.floor(entry.points * 0.12) + Math.floor(Math.random() * 3), // More realistic calculation\n      correctResults: Math.floor(entry.points * 0.25) + Math.floor(Math.random() * 2), // More realistic calculation\n      jokerUsed: entry.jokerUsed\n    }));\n  }\n\n  // Get all groups where the current user is a member (optimized for standings page)\n  getUserGroupsWithStandings(): GroupWithStandings[] {\n    const userGroups = this.getUserGroups();\n    const currentUser = this.authService.getCurrentUser();\n    \n    return userGroups.map(group => {\n      const leaderboard = this.getGroupLeaderboard(group.id);\n      const standings = this.convertToStandings(leaderboard);\n      const userPosition = currentUser \n        ? standings.findIndex(entry => entry.userId === currentUser.id) + 1\n        : null;\n      \n      return {\n        group: {\n          id: group.id,\n          name: group.name,\n          code: group.code,\n          memberCount: group.memberCount,\n          type: group.type\n        },\n        leaderboard: standings,\n        userPosition: userPosition || null\n      };\n    });\n  }\n\n  // Get specific group with standings (optimized for group-standings page)\n  getGroupWithStandings(groupId: string): GroupWithStandings | null {\n    const group = this.getAllGroups().find(g => g.id === groupId);\n    if (!group) return null;\n\n    const leaderboard = this.getGroupLeaderboard(groupId);\n    const standings = this.convertToStandings(leaderboard);\n    const currentUser = this.authService.getCurrentUser();\n    const userPosition = currentUser \n      ? standings.findIndex(entry => entry.userId === currentUser.id) + 1\n      : null;\n\n    return {\n      group: {\n        id: group.id,\n        name: group.name,\n        code: group.code,\n        memberCount: group.memberCount,\n        type: group.type\n      },\n      leaderboard: standings,\n      userPosition: userPosition || null\n    };\n  }\n\n  // Legacy method for backward compatibility - now optimized\n  getUserGroupsWithLeaderboards(): { group: Group; leaderboard: GroupLeaderboardEntry[]; userPosition: number | null }[] {\n    const userGroups = this.getUserGroups();\n    const currentUser = this.authService.getCurrentUser();\n    \n    return userGroups.map(group => {\n      const leaderboard = this.getGroupLeaderboard(group.id);\n      const userPosition = currentUser \n        ? leaderboard.findIndex(entry => entry.memberId === currentUser.id) + 1\n        : null;\n      \n      return {\n        group,\n        leaderboard,\n        userPosition: userPosition || null\n      };\n    });\n  }\n\n  // Get all groups where the current user is admin (for group-admin leaderboard page)\n  getAdminGroupsWithLeaderboards(): { group: Group; leaderboard: GroupLeaderboardEntry[]; adminPosition: number | null }[] {\n    const adminGroups = this.getAdminGroups();\n    const currentUser = this.authService.getCurrentUser();\n    \n    return adminGroups.map(group => {\n      const leaderboard = this.getGroupLeaderboard(group.id);\n      // For admins, we might want to show their position too if they're also participating\n      const adminPosition = currentUser \n        ? leaderboard.findIndex(entry => entry.memberId === currentUser.id) + 1\n        : null;\n      \n      return {\n        group,\n        leaderboard,\n        adminPosition: adminPosition || null\n      };\n    });\n  }\n\n  private generateGroupCode(): string {\n    const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';\n    let code = '';\n    for (let i = 0; i < 6; i++) {\n      code += chars.charAt(Math.floor(Math.random() * chars.length));\n    }\n    \n    // Ensure code is unique\n    const existingCodes = this.getAllGroups().map(g => g.code);\n    if (existingCodes.includes(code)) {\n      return this.generateGroupCode(); // Recursively generate until unique\n    }\n    \n    return code;\n  }\n\n  // Helper method to create a test group for demonstration\n  createTestGroup(): Group {\n    const testGroup: Group = {\n      id: crypto.randomUUID(),\n      name: 'Test Football Group',\n      code: 'TEST01',\n      memberCount: 2,\n      createdAt: new Date(),\n      members: [\n        {\n          id: 'admin-1',\n          name: 'John Admin',\n          email: 'admin@test.com',\n          joinedAt: new Date(),\n          status: 'active',\n          role: 'admin'\n        },\n        {\n          id: 'player-1',\n          name: 'Sarah Player',\n          email: 'player@test.com',\n          joinedAt: new Date(),\n          status: 'active',\n          role: 'player'\n        }\n      ],\n      settings: {\n        allowPlayerInvites: true,\n        autoApproveJoins: true,\n        showLeaderboard: true,\n        allowMemberChat: true,\n      },\n      type: 'casual',\n      entryFee: 0,\n      paidMembers: 0,\n      totalPrizePool: 0,\n      adminName: 'John Admin',\n      leaderboard: [],\n    };\n\n    this.saveGroup(testGroup);\n    return testGroup;\n  }\n\n  // Create a test group that current user can join as player\n  createJoinableTestGroup(): Group {\n    const testGroup: Group = {\n      id: crypto.randomUUID(),\n      name: 'Joinable Test Group',\n      code: 'JOIN01',\n      memberCount: 1,\n      createdAt: new Date(),\n      members: [\n        {\n          id: 'different-admin-id',\n          name: 'Test Admin',\n          email: 'testadmin@example.com',\n          joinedAt: new Date(),\n          status: 'active',\n          role: 'admin'\n        }\n      ],\n      settings: {\n        allowPlayerInvites: true,\n        autoApproveJoins: true,\n        showLeaderboard: true,\n        allowMemberChat: true,\n      },\n      type: 'casual',\n      entryFee: 0,\n      paidMembers: 0,\n      totalPrizePool: 0,\n      adminName: 'Test Admin',\n      leaderboard: [],\n    };\n\n    this.saveGroup(testGroup);\n\n    return testGroup;\n  }\n\n  /**\n   * Debug method to show current storage state (useful for testing)\n   */\n  public debugStorageState(): void {\n    const currentUser = this.authService.getCurrentUser();\n\n\n    \n    // Show global storage (new approach)\n    const globalData = localStorage.getItem(this.GLOBAL_GROUPS_KEY);\n\n    \n    // Show legacy storage for comparison\n    const legacyData = localStorage.getItem(this.LEGACY_STORAGE_KEY);\n\n    \n    // Show all sotd_groups keys in localStorage\n    const allKeys = Object.keys(localStorage).filter(key => key.startsWith('sotd_'));\n\n    \n    // Show user-specific group filtering results\n    if (currentUser) {\n      const userGroups = this.getUserGroups();\n      const adminGroups = this.getAdminGroups();\n\n\n    }\n  }\n}\n"],"names":["of","BehaviorSubject","GroupService","constructor","authService","STORAGE_KEY_PREFIX","USER_GROUPS_KEY_PREFIX","LEGACY_STORAGE_KEY","GLOBAL_GROUPS_KEY","groupsSubject","groups$","asObservable","initializeGlobalStorage","currentUser","subscribe","authResponse","handleUserChange","user","loadGroups","next","reinitializeForCurrentUser","globalData","localStorage","getItem","legacyData","legacyGroups","JSON","parse","setItem","stringify","error","console","getUserSpecificStorageKey","getCurrentUser","id","userSpecificKey","clearUserGroupData","groups","getAllGroups","groupsJson","map","group","createdAt","Date","members","member","joinedAt","getUserGroups","email","allGroups","userGroups","filter","some","getAdminGroups","adminGroups","role","saveGroup","Error","existingIndex","findIndex","g","push","findGroupByCode","code","find","joinGroup","groupCode","customMember","groupIndex","forEach","index","existingMemberById","m","existingMemberByEmail","existingMember","name","firstName","lastName","username","status","memberCount","length","leaderboard","deleteGroup","groupId","createGroup","data","adminMember","newGroup","crypto","randomUUID","generateGroupCode","settings","allowPlayerInvites","autoApproveJoins","showLeaderboard","allowMemberChat","type","entryFee","paidMembers","totalPrizePool","adminName","savedGroups","getGroupLeaderboard","mockLeaderboard","generateMockLeaderboard","basePoints","Math","floor","random","pointsVariation","pointVariation","memberPoints","max","position","memberId","memberName","played","points","totalPoints","jokerUsed","rank","trend","sort","a","b","entry","convertToStandings","entries","previousPosition","userId","correctScores","correctResults","getUserGroupsWithStandings","standings","userPosition","getGroupWithStandings","getUserGroupsWithLeaderboards","getAdminGroupsWithLeaderboards","adminPosition","chars","i","charAt","existingCodes","includes","createTestGroup","testGroup","createJoinableTestGroup","debugStorageState","allKeys","Object","keys","key","startsWith","i0","ɵɵinject","i1","AuthService","factory","ɵfac","providedIn"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}