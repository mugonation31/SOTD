"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[803],{5423:(b,p,s)=>{s.d(p,{f:()=>f});var u=s(467),i=s(4438),c=s(4738);let f=(()=>{var d;class g{constructor(o){this.toastController=o}showToast(o){var w=this;return(0,u.A)(function*(C,P="success",M=3e3){const O="error"===P?"danger":P;yield(yield w.toastController.create({message:C,color:O,duration:M,position:"bottom"})).present()}).apply(this,arguments)}}return(d=g).\u0275fac=function(o){return new(o||d)(i.KVO(c.K_))},d.\u0275prov=i.jDH({token:d,factory:d.\u0275fac,providedIn:"root"}),g})()},6803:(b,p,s)=>{s.r(p),s.d(p,{ResetPasswordPage:()=>x});var u=s(467),i=s(4738),c=s(4341),f=s(177),d=s(5079),g=s(5873),m=s(9620),o=s(4438),w=s(8010),C=s(5423),P=s(7570);function M(a,l){if(1&a&&(o.j41(0,"ion-note",18),o.EFF(1),o.k0s()),2&a){const _=o.XpG();o.R7$(),o.SpI(" ",_.validationErrors.password," ")}}function O(a,l){if(1&a&&(o.j41(0,"ion-note",18),o.EFF(1),o.k0s()),2&a){const _=o.XpG();o.R7$(),o.SpI(" ",_.validationErrors.confirmPassword," ")}}function k(a,l){1&a&&(o.j41(0,"span"),o.EFF(1,"Reset Password"),o.k0s())}function R(a,l){1&a&&(o.j41(0,"span"),o.EFF(1,"Resetting..."),o.k0s())}let x=(()=>{var a;class l{get canSubmit(){return!(!this.resetData.password||!this.resetData.confirmPassword||this.validationErrors.password||this.validationErrors.confirmPassword||!this.accessToken)}constructor(n,t,e,r){this.authService=n,this.toastService=t,this.router=e,this.route=r,this.resetData={password:"",confirmPassword:""},this.validationErrors={password:"",confirmPassword:""},this.showPassword=!1,this.showConfirmPassword=!1,this.isLoading=!1,this.accessToken="",this.refreshToken="",console.log("\u{1f3d7}\ufe0f ResetPasswordPage: Component constructed"),(0,d.a)({footballOutline:g.gMr,eye:g.y5U,eyeOff:g.zsm})}ngOnInit(){console.log("\u{1f504} ResetPasswordPage: ngOnInit called"),localStorage.removeItem("test_reset_token"),console.log("\u{1f310} ResetPasswordPage: Full URL:",window.location.href),console.log("\u{1f517} ResetPasswordPage: Current location:",window.location.toString()),this.route.queryParams.subscribe(n=>{console.log("\u{1f4cb} ResetPasswordPage: Received query parameters:",n),this.accessToken||(this.accessToken=n.code||n.access_token||n.token||n.reset_token||"",this.accessToken?(console.log("\u2705 ResetPasswordPage: Access token set from query params"),localStorage.setItem("current_reset_token",this.accessToken),this.validationErrors.password=""):(console.error("\u274c ResetPasswordPage: No access token found in query params"),this.validationErrors.password="Invalid reset link. Please request a new password reset."))}),this.checkHashFragment(),this.checkUrlPathForToken(),this.checkRawUrlForToken(),console.log("\u{1f4cd} ResetPasswordPage: Current route:",this.router.url),this.checkSupabaseSession()}checkSupabaseSession(){var n=this;return(0,u.A)(function*(){try{console.log("\u{1f50d} ResetPasswordPage: Setting Supabase session from URL fragment..."),(yield n.authService.setSessionFromFragment())?console.log("\u2705 Supabase session established successfully"):console.error("\u274c Failed to establish Supabase session")}catch(t){console.error("\u274c Error setting Supabase session:",t)}})()}checkUrlPathForToken(){const n=this.router.url.split("/");console.log("\u{1f50d} ResetPasswordPage: URL path segments:",n);for(const t of n)if(t.length>50&&!this.accessToken){console.log("\u{1f50d} ResetPasswordPage: Found potential token in URL path:",t.substring(0,20)+"..."),this.accessToken=t,localStorage.setItem("current_reset_token",t),this.validationErrors.password="";break}}checkRawUrlForToken(){const n=window.location.href;console.log("\u{1f50d} ResetPasswordPage: Checking raw URL for tokens:",n);const t=[/[?&]token=([^&]+)/,/[?&]access_token=([^&]+)/,/[?&]code=([^&]+)/,/[?&]reset_token=([^&]+)/,/#access_token=([^&]+)/,/#token=([^&]+)/];for(const e of t){const r=n.match(e);if(r&&r[1]&&!this.accessToken){console.log("\u{1f50d} ResetPasswordPage: Found token in raw URL with pattern:",e),this.accessToken=decodeURIComponent(r[1]),localStorage.setItem("current_reset_token",decodeURIComponent(r[1])),this.validationErrors.password="";break}}}setTestToken(n){localStorage.setItem("test_reset_token",n),this.accessToken=n,this.validationErrors.password="",console.log("\u{1f9ea} ResetPasswordPage: Test token set:",n.substring(0,20)+"...")}checkHashFragment(){const n=window.location.hash;if(n){console.log("\u{1f50d} ResetPasswordPage: Found hash fragment:",n);const t=new URLSearchParams(n.substring(1)),e=t.get("access_token");if(e){console.log("\u2705 ResetPasswordPage: Found access token in hash fragment"),this.accessToken=e,localStorage.setItem("current_reset_token",e);const h=t.get("refresh_token");return h&&(this.refreshToken=h,console.log("\u2705 ResetPasswordPage: Found refresh token in hash fragment")),void(this.validationErrors.password="")}const r=["code","token","reset_token","auth_token"];for(const h of r){const v=t.get(h);if(v)return console.log(`\u2705 ResetPasswordPage: Found ${h} in hash fragment`),this.accessToken=v,localStorage.setItem("current_reset_token",v),void(this.validationErrors.password="")}}else console.log("\u{1f50d} ResetPasswordPage: No hash fragment found")}validatePassword(){if(this.resetData.password)if((0,m.Oj)(this.resetData.password))this.validationErrors.password="";else{const n=(0,m.HJ)(this.resetData.password);this.validationErrors.password=n.join(", ")}else this.validationErrors.password="Password is required"}validateConfirmPassword(){this.validationErrors.confirmPassword=this.resetData.confirmPassword?this.resetData.password!==this.resetData.confirmPassword?"Passwords do not match":"":"Please confirm your password"}togglePasswordVisibility(){this.showPassword=!this.showPassword}toggleConfirmPasswordVisibility(){this.showConfirmPassword=!this.showConfirmPassword}onSubmit(){var n=this;return(0,u.A)(function*(){if(console.log("\u{1f680} ResetPasswordPage: Submit button clicked"),n.validatePassword(),n.validateConfirmPassword(),n.canSubmit&&!n.isLoading){console.log("\u2705 ResetPasswordPage: Validation passed, starting reset process"),n.isLoading=!0,n.authService.enableSupabaseAuth();try{if(!(yield n.authService.updatePasswordWithTokens(n.resetData.password)))throw new Error("Password update failed");localStorage.removeItem("current_reset_token"),yield n.toastService.showToast("Password reset successful! You can now log in with your new password.","success"),n.router.navigate(["/auth/login"])}catch(t){console.error("Password reset error:",t),localStorage.removeItem("current_reset_token");const e=(null==t?void 0:t.message)||"Failed to reset password. Please try again.";yield n.toastService.showToast(e,"error"),n.validationErrors.password=e}finally{n.isLoading=!1,console.log("\u{1f3c1} ResetPasswordPage: Reset operation completed, loading state cleared")}}else console.log("\u274c ResetPasswordPage: Cannot submit - canSubmit:",n.canSubmit,"isLoading:",n.isLoading)})()}navigateToWelcome(){this.router.navigate(["/welcome"])}}return(a=l).\u0275fac=function(n){return new(n||a)(o.rXU(w.u),o.rXU(C.f),o.rXU(P.Ix),o.rXU(P.nX))},a.\u0275cmp=o.VBU({type:a,selectors:[["app-reset-password"]],standalone:!0,features:[o.aNF],decls:33,vars:15,consts:[[1,"logo-container",3,"click"],["name","football-outline",1,"football-icon"],[1,"logo-text"],[1,"logo-sotd"],[1,"logo-subtitle"],[1,"ion-padding"],[1,"auth-card"],[1,"auth-header"],[3,"ngSubmit"],[1,"auth-form"],["placeholder","New Password","name","password","required","",3,"ngModelChange","ngModel","type"],["fill","clear","slot","end",3,"click"],[3,"name"],["slot","error",4,"ngIf"],["placeholder","Confirm New Password","name","confirmPassword","required","",3,"ngModelChange","ngModel","type"],[1,"auth-actions"],["expand","block","type","submit",3,"disabled"],[4,"ngIf"],["slot","error"]],template:function(n,t){1&n&&(o.j41(0,"ion-header")(1,"ion-toolbar")(2,"div",0),o.bIt("click",function(){return t.navigateToWelcome()}),o.nrm(3,"ion-icon",1),o.j41(4,"div",2)(5,"span",3),o.EFF(6,"SOTD"),o.k0s(),o.j41(7,"span",4),o.EFF(8,"Predict 3"),o.k0s()()()()(),o.j41(9,"ion-content",5)(10,"ion-card",6)(11,"ion-card-content")(12,"div",7)(13,"h1"),o.EFF(14,"Reset Password"),o.k0s(),o.j41(15,"p"),o.EFF(16,"Enter your new password"),o.k0s()(),o.j41(17,"form",8),o.bIt("ngSubmit",function(){return t.onSubmit()}),o.j41(18,"ion-list",9)(19,"ion-item")(20,"ion-input",10),o.mxI("ngModelChange",function(r){return o.DH7(t.resetData.password,r)||(t.resetData.password=r),r}),o.bIt("ngModelChange",function(){return t.validatePassword()}),o.k0s(),o.j41(21,"ion-button",11),o.bIt("click",function(){return t.togglePasswordVisibility()}),o.nrm(22,"ion-icon",12),o.k0s(),o.DNE(23,M,2,1,"ion-note",13),o.k0s(),o.j41(24,"ion-item")(25,"ion-input",14),o.mxI("ngModelChange",function(r){return o.DH7(t.resetData.confirmPassword,r)||(t.resetData.confirmPassword=r),r}),o.bIt("ngModelChange",function(){return t.validateConfirmPassword()}),o.k0s(),o.j41(26,"ion-button",11),o.bIt("click",function(){return t.toggleConfirmPasswordVisibility()}),o.nrm(27,"ion-icon",12),o.k0s(),o.DNE(28,O,2,1,"ion-note",13),o.k0s()(),o.j41(29,"div",15)(30,"ion-button",16),o.DNE(31,k,2,0,"span",17)(32,R,2,0,"span",17),o.k0s()()()()()()),2&n&&(o.R7$(20),o.AVh("ion-invalid",t.validationErrors.password),o.R50("ngModel",t.resetData.password),o.Y8G("type",t.showPassword?"text":"password"),o.R7$(2),o.Y8G("name",t.showPassword?"eye-off":"eye"),o.R7$(),o.Y8G("ngIf",t.validationErrors.password),o.R7$(2),o.AVh("ion-invalid",t.validationErrors.confirmPassword),o.R50("ngModel",t.resetData.confirmPassword),o.Y8G("type",t.showConfirmPassword?"text":"password"),o.R7$(2),o.Y8G("name",t.showConfirmPassword?"eye-off":"eye"),o.R7$(),o.Y8G("ngIf",t.validationErrors.confirmPassword),o.R7$(2),o.Y8G("disabled",!t.canSubmit||t.isLoading),o.R7$(),o.Y8G("ngIf",!t.isLoading),o.R7$(),o.Y8G("ngIf",t.isLoading))},dependencies:[i.eU,i.ai,i.W9,i.$w,i.Jm,i.iq,i.uz,i.nf,i.b_,i.I9,i.JI,c.YN,c.qT,c.BC,c.cb,c.YS,c.vS,c.cV,f.bT],styles:['.login-container[_ngcontent-%COMP%], .signup-container[_ngcontent-%COMP%], .forgot-password-container[_ngcontent-%COMP%], .otp-container[_ngcontent-%COMP%]{max-width:400px;margin:0 auto;padding:20px}.title[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;color:var(--ion-color-dark);margin-bottom:8px;text-align:center}.subtitle[_ngcontent-%COMP%]{color:var(--ion-color-medium);text-align:center;margin-bottom:24px}ion-card[_ngcontent-%COMP%]{box-shadow:0 4px 12px #0000001a;border-radius:16px}ion-card[_ngcontent-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:24px}ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;--background: transparent;--border-color: var(--ion-color-light);margin-bottom:16px}ion-button[expand=block][_ngcontent-%COMP%]{margin-top:24px;margin-bottom:24px;--border-radius: 8px;height:48px;font-weight:600}.social-signup[_ngcontent-%COMP%]{text-align:center}.social-signup[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{color:var(--ion-color-medium);position:relative;margin:24px 0}.social-signup[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]:before, .social-signup[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;width:25%;height:1px;background-color:var(--ion-color-light)}.social-signup[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]:before{left:0}.social-signup[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]:after{right:0}.social-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:16px;margin-bottom:24px}.social-buttons[_ngcontent-%COMP%]   .social-button[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;width:48px;height:48px}.social-buttons[_ngcontent-%COMP%]   .social-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:24px}.login-link[_ngcontent-%COMP%], .signup-link[_ngcontent-%COMP%], .forgot-password[_ngcontent-%COMP%], .resend-link[_ngcontent-%COMP%]{text-align:center;color:var(--ion-color-medium)}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .signup-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .forgot-password[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], .resend-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ion-color-primary);text-decoration:none;font-weight:500;cursor:pointer}.login-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .signup-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .forgot-password[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, .resend-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.forgot-password[_ngcontent-%COMP%]{text-align:right;margin-top:-8px;margin-bottom:16px}.forgot-password[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ion-color-primary);text-decoration:none;font-weight:500;font-size:.9rem;padding:8px 0;display:inline-block}.forgot-password[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline;opacity:.8}@media (max-width: 480px){.login-container[_ngcontent-%COMP%], .signup-container[_ngcontent-%COMP%], .forgot-password-container[_ngcontent-%COMP%], .otp-container[_ngcontent-%COMP%]{padding:16px}.title[_ngcontent-%COMP%]{font-size:1.75rem}}.logo-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px}.auth-footer[_ngcontent-%COMP%]{text-align:center}.auth-footer[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center;margin:2.5rem 0;text-align:center;gap:1rem}.auth-footer[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]:before, .auth-footer[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]:after{content:"";flex:1;height:1px;background:var(--ion-color-light-shade)}.auth-footer[_ngcontent-%COMP%]   .divider[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:var(--ion-color-medium);white-space:nowrap}.auth-footer[_ngcontent-%COMP%]   .social-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:1rem;margin-bottom:1.5rem}.auth-footer[_ngcontent-%COMP%]   .social-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0;width:40px;height:40px;--border-radius: 50%;--background: var(--ion-color-light)}.auth-footer[_ngcontent-%COMP%]   .social-buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:18px}.auth-footer[_ngcontent-%COMP%]   .auth-link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--ion-color-primary);text-decoration:none;font-weight:500;margin-left:4px}ion-toolbar[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0}.logo-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;cursor:pointer;transition:opacity .2s ease}.logo-container[_ngcontent-%COMP%]:hover{opacity:.8}.football-icon[_ngcontent-%COMP%]{font-size:24px;color:var(--ion-color-primary)}.logo-text[_ngcontent-%COMP%]{display:flex;flex-direction:column}.logo-sotd[_ngcontent-%COMP%]{font-size:18px;font-weight:600;line-height:1.2}.logo-subtitle[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium);line-height:1}.auth-card[_ngcontent-%COMP%]{max-width:400px;margin:0 auto;box-shadow:none;background:transparent}.auth-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:2rem}.auth-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;font-weight:700;margin-bottom:8px;color:var(--ion-color-dark)}.auth-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--ion-color-medium);margin:0}.auth-form[_ngcontent-%COMP%]{background:#fff;border-radius:8px;margin-bottom:1rem;padding:.5rem}.auth-form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]{--background: white;--border-color: transparent;--border-radius: 8px;--highlight-height: 0;--padding-start: 8px;--padding-end: 8px;--inner-padding-end: 8px;height:48px;box-shadow:0 2px 4px #0000000d;margin:0 4px 16px}.auth-form[_ngcontent-%COMP%]   ion-item.ion-invalid[_ngcontent-%COMP%]{--background: var(--ion-color-light)}.auth-form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.auth-form[_ngcontent-%COMP%]   ion-item[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{--padding-start: 8px;--background: transparent;--color: var(--ion-color-dark);--placeholder-color: var(--ion-color-medium)}.auth-form[_ngcontent-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:12px;margin:4px 8px}.auth-actions[_ngcontent-%COMP%]{margin:1.5rem 0}.auth-actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:0}@media (max-width: 576px){.auth-card[_ngcontent-%COMP%]{box-shadow:none;background:transparent;margin:0;padding:0}ion-content[_ngcontent-%COMP%]{--padding-start: 16px;--padding-end: 16px}}']}),l})()}}]);