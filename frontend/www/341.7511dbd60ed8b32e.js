(self.webpackChunkapp=self.webpackChunkapp||[]).push([[341],{3341:(G,w,b)=>{"use strict";b.r(w),b.d(w,{WelcomePage:()=>Pn});var P=b(252),j=b(177),B=b(5079),T=b(5873),u=b(4438),g=b(8199),p=b(8010);class k extends Error{constructor(r,e="FunctionsError",t){super(r),this.name=e,this.context=t}}class $ extends k{constructor(r){super("Failed to send a request to the Edge Function","FunctionsFetchError",r)}}class R extends k{constructor(r){super("Relay Error invoking the Edge Function","FunctionsRelayError",r)}}class C extends k{constructor(r){super("Edge Function returned a non-2xx status code","FunctionsHttpError",r)}}var I=function(s){return s.Any="any",s.ApNortheast1="ap-northeast-1",s.ApNortheast2="ap-northeast-2",s.ApSouth1="ap-south-1",s.ApSoutheast1="ap-southeast-1",s.ApSoutheast2="ap-southeast-2",s.CaCentral1="ca-central-1",s.EuCentral1="eu-central-1",s.EuWest1="eu-west-1",s.EuWest2="eu-west-2",s.EuWest3="eu-west-3",s.SaEast1="sa-east-1",s.UsEast1="us-east-1",s.UsWest1="us-west-1",s.UsWest2="us-west-2",s}(I||{});class X{constructor(r,{headers:e={},customFetch:t,region:n=I.Any}={}){this.url=r,this.headers=e,this.region=n,this.fetch=(s=>{let r;return r=s||(typeof fetch>"u"?(...e)=>Promise.resolve().then(b.bind(b,5286)).then(({default:t})=>t(...e)):fetch),(...e)=>r(...e)})(t)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,e={}){var t;return function(s,r,e,t){return new(e||(e=Promise))(function(i,o){function a(c){try{d(t.next(c))}catch(h){o(h)}}function l(c){try{d(t.throw(c))}catch(h){o(h)}}function d(c){c.done?i(c.value):function n(i){return i instanceof e?i:new e(function(o){o(i)})}(c.value).then(a,l)}d((t=t.apply(s,r||[])).next())})}(this,void 0,void 0,function*(){try{const{headers:n,method:i,body:o}=e;let a={},{region:l}=e;l||(l=this.region);const d=new URL(`${this.url}/${r}`);let c;l&&"any"!==l&&(a["x-region"]=l,d.searchParams.set("forceFunctionRegion",l)),o&&(n&&!Object.prototype.hasOwnProperty.call(n,"Content-Type")||!n)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(a["Content-Type"]="application/octet-stream",c=o):"string"==typeof o?(a["Content-Type"]="text/plain",c=o):typeof FormData<"u"&&o instanceof FormData?c=o:(a["Content-Type"]="application/json",c=JSON.stringify(o)));const h=yield this.fetch(d.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},a),this.headers),n),body:c}).catch(x=>{throw new $(x)}),_=h.headers.get("x-relay-error");if(_&&"true"===_)throw new R(h);if(!h.ok)throw new C(h);let v,m=(null!==(t=h.headers.get("Content-Type"))&&void 0!==t?t:"text/plain").split(";")[0].trim();return v="application/json"===m?yield h.json():"application/octet-stream"===m?yield h.blob():"text/event-stream"===m?h:"multipart/form-data"===m?yield h.formData():yield h.text(),{data:v,error:null,response:h}}catch(n){return{data:null,error:n,response:n instanceof C||n instanceof R?n.context:void 0}}})}}var ee=b(4060);const{PostgrestClient:L}=ee;var f=b(467);const Dt=function ge(){if(typeof WebSocket<"u")return WebSocket;if(typeof global.WebSocket<"u")return global.WebSocket;if(typeof window.WebSocket<"u")return window.WebSocket;if(typeof self.WebSocket<"u")return self.WebSocket;throw new Error("`WebSocket` is not supported in this environment")}();var Te=function(s){return s[s.connecting=0]="connecting",s[s.open=1]="open",s[s.closing=2]="closing",s[s.closed=3]="closed",s}(Te||{}),H=function(s){return s.closed="closed",s.errored="errored",s.joined="joined",s.joining="joining",s.leaving="leaving",s}(H||{}),te=function(s){return s.close="phx_close",s.error="phx_error",s.join="phx_join",s.reply="phx_reply",s.leave="phx_leave",s.access_token="access_token",s}(te||{}),ut=function(s){return s.websocket="websocket",s}(ut||{}),pe=function(s){return s.Connecting="connecting",s.Open="open",s.Closing="closing",s.Closed="closed",s}(pe||{});class qt{constructor(){this.HEADER_LENGTH=1}decode(r,e){return r.constructor===ArrayBuffer?e(this._binaryDecode(r)):e("string"==typeof r?JSON.parse(r):{})}_binaryDecode(r){const e=new DataView(r),t=new TextDecoder;return this._decodeBroadcast(r,e,t)}_decodeBroadcast(r,e,t){const n=e.getUint8(1),i=e.getUint8(2);let o=this.HEADER_LENGTH+2;const a=t.decode(r.slice(o,o+n));o+=n;const l=t.decode(r.slice(o,o+i));return o+=i,{ref:null,topic:a,event:l,payload:JSON.parse(t.decode(r.slice(o,r.byteLength)))}}}class dt{constructor(r,e){this.callback=r,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var U=function(s){return s.abstime="abstime",s.bool="bool",s.date="date",s.daterange="daterange",s.float4="float4",s.float8="float8",s.int2="int2",s.int4="int4",s.int4range="int4range",s.int8="int8",s.int8range="int8range",s.json="json",s.jsonb="jsonb",s.money="money",s.numeric="numeric",s.oid="oid",s.reltime="reltime",s.text="text",s.time="time",s.timestamp="timestamp",s.timestamptz="timestamptz",s.timetz="timetz",s.tsrange="tsrange",s.tstzrange="tstzrange",s}(U||{});const ht=(s,r,e={})=>{var t;const n=null!==(t=e.skipTypes)&&void 0!==t?t:[];return Object.keys(r).reduce((i,o)=>(i[o]=Wt(o,s,r,n),i),{})},Wt=(s,r,e,t)=>{const n=r.find(a=>a.name===s),i=null==n?void 0:n.type,o=e[s];return i&&!t.includes(i)?ft(i,o):Me(o)},ft=(s,r)=>{if("_"===s.charAt(0)){const e=s.slice(1,s.length);return Ht(r,e)}switch(s){case U.bool:return zt(r);case U.float4:case U.float8:case U.int2:case U.int4:case U.int8:case U.numeric:case U.oid:return Gt(r);case U.json:case U.jsonb:return Jt(r);case U.timestamp:return Kt(r);default:return Me(r)}},Me=s=>s,zt=s=>{switch(s){case"t":return!0;case"f":return!1;default:return s}},Gt=s=>{if("string"==typeof s){const r=parseFloat(s);if(!Number.isNaN(r))return r}return s},Jt=s=>{if("string"==typeof s)try{return JSON.parse(s)}catch(r){return console.log(`JSON parse error: ${r}`),s}return s},Ht=(s,r)=>{if("string"!=typeof s)return s;const e=s.length-1;if("{"===s[0]&&"}"===s[e]){let i;const o=s.slice(1,e);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(a=>ft(r,a))}return s},Kt=s=>"string"==typeof s?s.replace(" ","T"):s,gt=s=>{let r=s;return r=r.replace(/^ws/i,"http"),r=r.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),r.replace(/\/+$/,"")};class De{constructor(r,e,t={},n=1e4){this.channel=r,this.event=e,this.payload=t,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,e){var t;return this._hasReceived(r)&&e(null===(t=this.receivedResp)||void 0===t?void 0:t.response),this.recHooks.push({status:r,callback:e}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(r,e){this.refEvent&&this.channel._trigger(this.refEvent,{status:r,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:e}){this.recHooks.filter(t=>t.status===r).forEach(t=>t.callback(e))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}class ke{constructor(r,e){this.channel=r,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const t=(null==e?void 0:e.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(t.state,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.joinRef=this.channel._joinRef(),this.state=ke.syncState(this.state,n,i,o),this.pendingDiffs.forEach(l=>{this.state=ke.syncDiff(this.state,l,i,o)}),this.pendingDiffs=[],a()}),this.channel._on(t.diff,{},n=>{const{onJoin:i,onLeave:o,onSync:a}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(n):(this.state=ke.syncDiff(this.state,n,i,o),a())}),this.onJoin((n,i,o)=>{this.channel._trigger("presence",{event:"join",key:n,currentPresences:i,newPresences:o})}),this.onLeave((n,i,o)=>{this.channel._trigger("presence",{event:"leave",key:n,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(r,e,t,n){const i=this.cloneDeep(r),o=this.transformState(e),a={},l={};return this.map(i,(d,c)=>{o[d]||(l[d]=c)}),this.map(o,(d,c)=>{const h=i[d];if(h){const _=c.map(S=>S.presence_ref),m=h.map(S=>S.presence_ref),v=c.filter(S=>m.indexOf(S.presence_ref)<0),x=h.filter(S=>_.indexOf(S.presence_ref)<0);v.length>0&&(a[d]=v),x.length>0&&(l[d]=x)}else a[d]=c}),this.syncDiff(i,{joins:a,leaves:l},t,n)}static syncDiff(r,e,t,n){const{joins:i,leaves:o}={joins:this.transformState(e.joins),leaves:this.transformState(e.leaves)};return t||(t=()=>{}),n||(n=()=>{}),this.map(i,(a,l)=>{var d;const c=null!==(d=r[a])&&void 0!==d?d:[];if(r[a]=this.cloneDeep(l),c.length>0){const h=r[a].map(m=>m.presence_ref),_=c.filter(m=>h.indexOf(m.presence_ref)<0);r[a].unshift(..._)}t(a,c,l)}),this.map(o,(a,l)=>{let d=r[a];if(!d)return;const c=l.map(h=>h.presence_ref);d=d.filter(h=>c.indexOf(h.presence_ref)<0),r[a]=d,n(a,d,l),0===d.length&&delete r[a]}),r}static map(r,e){return Object.getOwnPropertyNames(r).map(t=>e(t,r[t]))}static transformState(r){return r=this.cloneDeep(r),Object.getOwnPropertyNames(r).reduce((e,t)=>{const n=r[t];return e[t]="metas"in n?n.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n,e},{})}static cloneDeep(r){return JSON.parse(JSON.stringify(r))}onJoin(r){this.caller.onJoin=r}onLeave(r){this.caller.onLeave=r}onSync(r){this.caller.onSync=r}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var ne=function(s){return s.SUBSCRIBED="SUBSCRIBED",s.TIMED_OUT="TIMED_OUT",s.CLOSED="CLOSED",s.CHANNEL_ERROR="CHANNEL_ERROR",s}(ne||{});class Fe{constructor(r,e={config:{}},t){this.topic=r,this.params=e,this.socket=t,this.bindings={},this.state=H.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=r.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},e.config),this.timeout=this.socket.timeout,this.joinPush=new De(this,te.join,this.params,this.timeout),this.rejoinTimer=new dt(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=H.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=H.closed,this.socket._remove(this)}),this._onError(n=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=H.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=H.errored,this.rejoinTimer.scheduleTimeout())}),this._on(te.reply,{},(n,i)=>{this._trigger(this._replyEventName(i),n)}),this.presence=new ke(this),this.broadcastEndpointURL=gt(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(r,e=this.timeout){var n,i,t=this;if(this.socket.isConnected()||this.socket.connect(),this.state==H.closed){const{config:{broadcast:o,presence:a,private:l}}=this.params;this._onError(h=>null==r?void 0:r(ne.CHANNEL_ERROR,h)),this._onClose(()=>null==r?void 0:r(ne.CLOSED));const d={},c={broadcast:o,presence:a,postgres_changes:null!==(i=null===(n=this.bindings.postgres_changes)||void 0===n?void 0:n.map(h=>h.filter))&&void 0!==i?i:[],private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},d)),this.joinedOnce=!0,this._rejoin(e),this.joinPush.receive("ok",function(){var h=(0,f.A)(function*({postgres_changes:_}){var m;if(t.socket.setAuth(),void 0!==_){const v=t.bindings.postgres_changes,x=null!==(m=null==v?void 0:v.length)&&void 0!==m?m:0,S=[];for(let D=0;D<x;D++){const M=v[D],{filter:{event:W,schema:K,table:A,filter:N}}=M,Z=_&&_[D];if(!Z||Z.event!==W||Z.schema!==K||Z.table!==A||Z.filter!==N)return t.unsubscribe(),t.state=H.errored,void(null==r||r(ne.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));S.push(Object.assign(Object.assign({},M),{id:Z.id}))}return t.bindings.postgres_changes=S,void(r&&r(ne.SUBSCRIBED))}null==r||r(ne.SUBSCRIBED)});return function(_){return h.apply(this,arguments)}}()).receive("error",h=>{this.state=H.errored,null==r||r(ne.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(h).join(", ")||"error")))}).receive("timeout",()=>{null==r||r(ne.TIMED_OUT)})}return this}presenceState(){return this.presence.state}track(r){var e=this;return(0,f.A)(function*(t,n={}){return yield e.send({type:"presence",event:"track",payload:t},n.timeout||e.timeout)}).apply(this,arguments)}untrack(){var r=this;return(0,f.A)(function*(e={}){return yield r.send({type:"presence",event:"untrack"},e)}).apply(this,arguments)}on(r,e,t){return this._on(r,e,t)}send(r){var e=this;return(0,f.A)(function*(t,n={}){var i,o;if(e._canPush()||"broadcast"!==t.type)return new Promise(a=>{var l,d,c;const h=e._push(t.type,t,n.timeout||e.timeout);"broadcast"===t.type&&!(null!==(c=null===(d=null===(l=e.params)||void 0===l?void 0:l.config)||void 0===d?void 0:d.broadcast)&&void 0!==c&&c.ack)&&a("ok"),h.receive("ok",()=>a("ok")),h.receive("error",()=>a("error")),h.receive("timeout",()=>a("timed out"))});{const{event:a,payload:l}=t,c={method:"POST",headers:{Authorization:e.socket.accessTokenValue?`Bearer ${e.socket.accessTokenValue}`:"",apikey:e.socket.apiKey?e.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:e.subTopic,event:a,payload:l,private:e.private}]})};try{const h=yield e._fetchWithTimeout(e.broadcastEndpointURL,c,null!==(i=n.timeout)&&void 0!==i?i:e.timeout);return yield null===(o=h.body)||void 0===o?void 0:o.cancel(),h.ok?"ok":"error"}catch(h){return"AbortError"===h.name?"timed out":"error"}}}).apply(this,arguments)}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=H.leaving;const e=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(te.close,"leave",this._joinRef())};this.joinPush.destroy();let t=null;return new Promise(n=>{t=new De(this,te.leave,{},r),t.receive("ok",()=>{e(),n("ok")}).receive("timeout",()=>{e(),n("timed out")}).receive("error",()=>{n("error")}),t.send(),this._canPush()||t.trigger("ok",{})}).finally(()=>{null==t||t.destroy()})}teardown(){this.pushBuffer.forEach(r=>r.destroy()),this.rejoinTimer&&clearTimeout(this.rejoinTimer.timer),this.joinPush.destroy()}_fetchWithTimeout(r,e,t){var n=this;return(0,f.A)(function*(){const i=new AbortController,o=setTimeout(()=>i.abort(),t),a=yield n.socket.fetch(r,Object.assign(Object.assign({},e),{signal:i.signal}));return clearTimeout(o),a})()}_push(r,e,t=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new De(this,r,e,t);return this._canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}_onMessage(r,e,t){return e}_isMember(r){return this.topic===r}_joinRef(){return this.joinPush.ref}_trigger(r,e,t){var n,i;const o=r.toLocaleLowerCase(),{close:a,error:l,leave:d,join:c}=te;if(t&&[a,l,d,c].indexOf(o)>=0&&t!==this._joinRef())return;let _=this._onMessage(o,e,t);if(e&&!_)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?null===(n=this.bindings.postgres_changes)||void 0===n||n.filter(m=>{var v,x,S;return"*"===(null===(v=m.filter)||void 0===v?void 0:v.event)||(null===(S=null===(x=m.filter)||void 0===x?void 0:x.event)||void 0===S?void 0:S.toLocaleLowerCase())===o}).map(m=>m.callback(_,t)):null===(i=this.bindings[o])||void 0===i||i.filter(m=>{var v,x,S,D,M,W;if(["broadcast","presence","postgres_changes"].includes(o)){if("id"in m){const K=m.id,A=null===(v=m.filter)||void 0===v?void 0:v.event;return K&&(null===(x=e.ids)||void 0===x?void 0:x.includes(K))&&("*"===A||(null==A?void 0:A.toLocaleLowerCase())===(null===(S=e.data)||void 0===S?void 0:S.type.toLocaleLowerCase()))}{const K=null===(M=null===(D=null==m?void 0:m.filter)||void 0===D?void 0:D.event)||void 0===M?void 0:M.toLocaleLowerCase();return"*"===K||K===(null===(W=null==e?void 0:e.event)||void 0===W?void 0:W.toLocaleLowerCase())}}return m.type.toLocaleLowerCase()===o}).map(m=>{if("object"==typeof _&&"ids"in _){const v=_.data,{schema:x,table:S,commit_timestamp:D,type:M,errors:W}=v;_=Object.assign(Object.assign({},{schema:x,table:S,commit_timestamp:D,eventType:M,new:{},old:{},errors:W}),this._getPayloadRecords(v))}m.callback(_,t)})}_isClosed(){return this.state===H.closed}_isJoined(){return this.state===H.joined}_isJoining(){return this.state===H.joining}_isLeaving(){return this.state===H.leaving}_replyEventName(r){return`chan_reply_${r}`}_on(r,e,t){const n=r.toLocaleLowerCase(),i={type:n,filter:e,callback:t};return this.bindings[n]?this.bindings[n].push(i):this.bindings[n]=[i],this}_off(r,e){const t=r.toLocaleLowerCase();return this.bindings[t]=this.bindings[t].filter(n=>{var i;return!((null===(i=n.type)||void 0===i?void 0:i.toLocaleLowerCase())===t&&Fe.isEqual(n.filter,e))}),this}static isEqual(r,e){if(Object.keys(r).length!==Object.keys(e).length)return!1;for(const t in r)if(r[t]!==e[t])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(r){this._on(te.close,{},r)}_onError(r){this._on(te.error,{},e=>r(e))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(r=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=H.joining,this.joinPush.resend(r))}_getPayloadRecords(r){const e={new:{},old:{}};return("INSERT"===r.type||"UPDATE"===r.type)&&(e.new=ht(r.columns,r.record)),("UPDATE"===r.type||"DELETE"===r.type)&&(e.old=ht(r.columns,r.old_record)),e}}const pt=()=>{};class Zt{constructor(r,e){var n,t=this;this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.heartbeatIntervalMs=25e3,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=pt,this.ref=0,this.logger=pt,this.conn=null,this.sendBuffer=[],this.serializer=new qt,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=o=>{let a;return a=o||(typeof fetch>"u"?(...l)=>Promise.resolve().then(b.bind(b,5286)).then(({default:d})=>d(...l)):fetch),(...l)=>a(...l)},this.endPoint=`${r}/${ut.websocket}`,this.httpEndpoint=gt(r),this.transport=null!=e&&e.transport?e.transport:null,null!=e&&e.params&&(this.params=e.params),null!=e&&e.timeout&&(this.timeout=e.timeout),null!=e&&e.logger&&(this.logger=e.logger),(null!=e&&e.logLevel||null!=e&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),null!=e&&e.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs);const i=null===(n=null==e?void 0:e.params)||void 0===n?void 0:n.apikey;if(i&&(this.accessTokenValue=i,this.apiKey=i),this.reconnectAfterMs=null!=e&&e.reconnectAfterMs?e.reconnectAfterMs:o=>[1e3,2e3,5e3,1e4][o-1]||1e4,this.encode=null!=e&&e.encode?e.encode:(o,a)=>a(JSON.stringify(o)),this.decode=null!=e&&e.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new dt((0,f.A)(function*(){t.disconnect(),t.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==e?void 0:e.fetch),null!=e&&e.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==e?void 0:e.worker)||!1,this.workerUrl=null==e?void 0:e.workerUrl}this.accessToken=(null==e?void 0:e.accessToken)||null}connect(){if(!this.conn){if(this.transport||(this.transport=Dt),!this.transport)throw new Error("No transport provided");this.conn=new this.transport(this.endpointURL()),this.setupConnection()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(r,e){this.conn&&(this.conn.onclose=function(){},r?this.conn.close(r,null!=e?e:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset(),this.channels.forEach(t=>t.teardown()))}getChannels(){return this.channels}removeChannel(r){var e=this;return(0,f.A)(function*(){const t=yield r.unsubscribe();return 0===e.channels.length&&e.disconnect(),t})()}removeAllChannels(){var r=this;return(0,f.A)(function*(){const e=yield Promise.all(r.channels.map(t=>t.unsubscribe()));return r.channels=[],r.disconnect(),e})()}log(r,e,t){this.logger(r,e,t)}connectionState(){switch(this.conn&&this.conn.readyState){case Te.connecting:return pe.Connecting;case Te.open:return pe.Open;case Te.closing:return pe.Closing;default:return pe.Closed}}isConnected(){return this.connectionState()===pe.Open}channel(r,e={config:{}}){const t=`realtime:${r}`,n=this.getChannels().find(i=>i.topic===t);if(n)return n;{const i=new Fe(`realtime:${r}`,e,this);return this.channels.push(i),i}}push(r){const{topic:e,event:t,payload:n,ref:i}=r,o=()=>{this.encode(r,a=>{var l;null===(l=this.conn)||void 0===l||l.send(a)})};this.log("push",`${e} ${t} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}setAuth(){var r=this;return(0,f.A)(function*(e=null){let t=e||r.accessToken&&(yield r.accessToken())||r.accessTokenValue;r.accessTokenValue!=t&&(r.accessTokenValue=t,r.channels.forEach(n=>{t&&n.updateJoinPayload({access_token:t,version:"realtime-js/2.11.15"}),n.joinedOnce&&n._isJoined()&&n._push(te.access_token,{access_token:t})}))}).apply(this,arguments)}sendHeartbeat(){var r=this;return(0,f.A)(function*(){var e;if(r.isConnected())return r.pendingHeartbeatRef?(r.pendingHeartbeatRef=null,r.log("transport","heartbeat timeout. Attempting to re-establish connection"),r.heartbeatCallback("timeout"),void(null===(e=r.conn)||void 0===e||e.close(1e3,"hearbeat timeout"))):(r.pendingHeartbeatRef=r._makeRef(),r.push({topic:"phoenix",event:"heartbeat",payload:{},ref:r.pendingHeartbeatRef}),r.heartbeatCallback("sent"),void(yield r.setAuth()));r.heartbeatCallback("disconnected")})()}onHeartbeat(r){this.heartbeatCallback=r}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_makeRef(){let r=this.ref+1;return this.ref=r===this.ref?0:r,this.ref.toString()}_leaveOpenTopic(r){let e=this.channels.find(t=>t.topic===r&&(t._isJoined()||t._isJoining()));e&&(this.log("transport",`leaving duplicate topic "${r}"`),e.unsubscribe())}_remove(r){this.channels=this.channels.filter(e=>e.topic!==r.topic)}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this._onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r))}_onConnMessage(r){this.decode(r.data,e=>{let{topic:t,event:n,payload:i,ref:o}=e;"phoenix"===t&&"phx_reply"===n&&this.heartbeatCallback("ok"==e.payload.status?"ok":"error"),o&&o===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${t} ${n} ${o&&"("+o+")"||""}`,i),Array.from(this.channels).filter(a=>a._isMember(t)).forEach(a=>a._trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(a=>a(e))})}_onConnOpen(){this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this.stateChangeCallbacks.open.forEach(r=>r())}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.log("worker",this.workerUrl?`starting worker for from ${this.workerUrl}`:"starting default worker");const r=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(r),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(r){this.log("transport","close",r),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(r))}_onConnError(r){this.log("transport",`${r}`),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(r))}_triggerChanError(){this.channels.forEach(r=>r._trigger(te.error))}_appendParams(r,e){if(0===Object.keys(e).length)return r;const t=r.match(/\?/)?"&":"?";return`${r}${t}${new URLSearchParams(e)}`}_workerObjectUrl(r){let e;if(r)e=r;else{const t=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});e=URL.createObjectURL(t)}return e}}class Be extends Error{constructor(r){super(r),this.__isStorageError=!0,this.name="StorageError"}}function q(s){return"object"==typeof s&&null!==s&&"__isStorageError"in s}class er extends Be{constructor(r,e){super(r),this.name="StorageApiError",this.status=e}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ne extends Be{constructor(r,e){super(r),this.name="StorageUnknownError",this.originalError=e}}const _t=s=>{let r;return r=s||(typeof fetch>"u"?(...e)=>Promise.resolve().then(b.bind(b,5286)).then(({default:t})=>t(...e)):fetch),(...e)=>r(...e)},qe=s=>{if(Array.isArray(s))return s.map(e=>qe(e));if("function"==typeof s||s!==Object(s))return s;const r={};return Object.entries(s).forEach(([e,t])=>{const n=e.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));r[n]=qe(t)}),r};var ue=function(s,r,e,t){return new(e||(e=Promise))(function(i,o){function a(c){try{d(t.next(c))}catch(h){o(h)}}function l(c){try{d(t.throw(c))}catch(h){o(h)}}function d(c){c.done?i(c.value):function n(i){return i instanceof e?i:new e(function(o){o(i)})}(c.value).then(a,l)}d((t=t.apply(s,r||[])).next())})};const We=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),nr=(s,r,e)=>ue(void 0,void 0,void 0,function*(){const t=yield function(s,r,e,t){return new(e||(e=Promise))(function(i,o){function a(c){try{d(t.next(c))}catch(h){o(h)}}function l(c){try{d(t.throw(c))}catch(h){o(h)}}function d(c){c.done?i(c.value):function n(i){return i instanceof e?i:new e(function(o){o(i)})}(c.value).then(a,l)}d((t=t.apply(s,r||[])).next())})}(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Promise.resolve().then(b.bind(b,5286))).Response:Response});s instanceof t&&(null==e||!e.noResolveJson)?s.json().then(n=>{r(new er(We(n),s.status||500))}).catch(n=>{r(new Ne(We(n),n))}):r(new Ne(We(s),s))}),sr=(s,r,e,t)=>{const n={method:s,headers:(null==r?void 0:r.headers)||{}};return"GET"===s?n:(n.headers=Object.assign({"Content-Type":"application/json"},null==r?void 0:r.headers),t&&(n.body=JSON.stringify(t)),Object.assign(Object.assign({},n),e))};function Ae(s,r,e,t,n,i){return ue(this,void 0,void 0,function*(){return new Promise((o,a)=>{s(e,sr(r,t,n,i)).then(l=>{if(!l.ok)throw l;return null!=t&&t.noResolveJson?l:l.json()}).then(l=>o(l)).catch(l=>nr(l,a,t))})})}function Ee(s,r,e,t){return ue(this,void 0,void 0,function*(){return Ae(s,"GET",r,e,t)})}function se(s,r,e,t,n){return ue(this,void 0,void 0,function*(){return Ae(s,"POST",r,t,n,e)})}function ir(s,r,e,t,n){return ue(this,void 0,void 0,function*(){return Ae(s,"PUT",r,t,n,e)})}function vt(s,r,e,t,n){return ue(this,void 0,void 0,function*(){return Ae(s,"DELETE",r,t,n,e)})}var V=function(s,r,e,t){return new(e||(e=Promise))(function(i,o){function a(c){try{d(t.next(c))}catch(h){o(h)}}function l(c){try{d(t.throw(c))}catch(h){o(h)}}function d(c){c.done?i(c.value):function n(i){return i instanceof e?i:new e(function(o){o(i)})}(c.value).then(a,l)}d((t=t.apply(s,r||[])).next())})};const ar={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},yt={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class lr{constructor(r,e={},t,n){this.url=r,this.headers=e,this.bucketId=t,this.fetch=_t(n)}uploadOrUpdate(r,e,t,n){return V(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},yt),n);let a=Object.assign(Object.assign({},this.headers),"POST"===r&&{"x-upsert":String(o.upsert)});const l=o.metadata;typeof Blob<"u"&&t instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l)),i.append("",t)):typeof FormData<"u"&&t instanceof FormData?(i=t,i.append("cacheControl",o.cacheControl),l&&i.append("metadata",this.encodeMetadata(l))):(i=t,a["cache-control"]=`max-age=${o.cacheControl}`,a["content-type"]=o.contentType,l&&(a["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),null!=n&&n.headers&&(a=Object.assign(Object.assign({},a),n.headers));const d=this._removeEmptyFolders(e),c=this._getFinalPath(d),h=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:r,body:i,headers:a},null!=o&&o.duplex?{duplex:o.duplex}:{})),_=yield h.json();return h.ok?{data:{path:d,id:_.Id,fullPath:_.Key},error:null}:{data:null,error:_}}catch(i){if(q(i))return{data:null,error:i};throw i}})}upload(r,e,t){return V(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,e,t)})}uploadToSignedUrl(r,e,t,n){return V(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(r),o=this._getFinalPath(i),a=new URL(this.url+`/object/upload/sign/${o}`);a.searchParams.set("token",e);try{let l;const d=Object.assign({upsert:yt.upsert},n),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&t instanceof Blob?(l=new FormData,l.append("cacheControl",d.cacheControl),l.append("",t)):typeof FormData<"u"&&t instanceof FormData?(l=t,l.append("cacheControl",d.cacheControl)):(l=t,c["cache-control"]=`max-age=${d.cacheControl}`,c["content-type"]=d.contentType);const h=yield this.fetch(a.toString(),{method:"PUT",body:l,headers:c}),_=yield h.json();return h.ok?{data:{path:i,fullPath:_.Key},error:null}:{data:null,error:_}}catch(l){if(q(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(r,e){return V(this,void 0,void 0,function*(){try{let t=this._getFinalPath(r);const n=Object.assign({},this.headers);null!=e&&e.upsert&&(n["x-upsert"]="true");const i=yield se(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:n}),o=new URL(this.url+i.url),a=o.searchParams.get("token");if(!a)throw new Be("No token returned by API");return{data:{signedUrl:o.toString(),path:r,token:a},error:null}}catch(t){if(q(t))return{data:null,error:t};throw t}})}update(r,e,t){return V(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,e,t)})}move(r,e,t){return V(this,void 0,void 0,function*(){try{return{data:yield se(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e,destinationBucket:null==t?void 0:t.destinationBucket},{headers:this.headers}),error:null}}catch(n){if(q(n))return{data:null,error:n};throw n}})}copy(r,e,t){return V(this,void 0,void 0,function*(){try{return{data:{path:(yield se(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e,destinationBucket:null==t?void 0:t.destinationBucket},{headers:this.headers})).Key},error:null}}catch(n){if(q(n))return{data:null,error:n};throw n}})}createSignedUrl(r,e,t){return V(this,void 0,void 0,function*(){try{let n=this._getFinalPath(r),i=yield se(this.fetch,`${this.url}/object/sign/${n}`,Object.assign({expiresIn:e},null!=t&&t.transform?{transform:t.transform}:{}),{headers:this.headers});const o=null!=t&&t.download?`&download=${!0===t.download?"":t.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(n){if(q(n))return{data:null,error:n};throw n}})}createSignedUrls(r,e,t){return V(this,void 0,void 0,function*(){try{const n=yield se(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:r},{headers:this.headers}),i=null!=t&&t.download?`&download=${!0===t.download?"":t.download}`:"";return{data:n.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(n){if(q(n))return{data:null,error:n};throw n}})}download(r,e){return V(this,void 0,void 0,function*(){const n=typeof(null==e?void 0:e.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((null==e?void 0:e.transform)||{}),o=i?`?${i}`:"";try{const a=this._getFinalPath(r);return{data:yield(yield Ee(this.fetch,`${this.url}/${n}/${a}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(a){if(q(a))return{data:null,error:a};throw a}})}info(r){return V(this,void 0,void 0,function*(){const e=this._getFinalPath(r);try{const t=yield Ee(this.fetch,`${this.url}/object/info/${e}`,{headers:this.headers});return{data:qe(t),error:null}}catch(t){if(q(t))return{data:null,error:t};throw t}})}exists(r){return V(this,void 0,void 0,function*(){const e=this._getFinalPath(r);try{return yield function or(s,r,e,t){return ue(this,void 0,void 0,function*(){return Ae(s,"HEAD",r,Object.assign(Object.assign({},e),{noResolveJson:!0}),t)})}(this.fetch,`${this.url}/object/${e}`,{headers:this.headers}),{data:!0,error:null}}catch(t){if(q(t)&&t instanceof Ne){const n=t.originalError;if([400,404].includes(null==n?void 0:n.status))return{data:!1,error:t}}throw t}})}getPublicUrl(r,e){const t=this._getFinalPath(r),n=[],i=null!=e&&e.download?`download=${!0===e.download?"":e.download}`:"";""!==i&&n.push(i);const a=typeof(null==e?void 0:e.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((null==e?void 0:e.transform)||{});""!==l&&n.push(l);let d=n.join("&");return""!==d&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${a}/public/${t}${d}`)}}}remove(r){return V(this,void 0,void 0,function*(){try{return{data:yield vt(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(e){if(q(e))return{data:null,error:e};throw e}})}list(r,e,t){return V(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},ar),e),{prefix:r||""});return{data:yield se(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},t),error:null}}catch(n){if(q(n))return{data:null,error:n};throw n}})}encodeMetadata(r){return JSON.stringify(r)}toBase64(r){return typeof Buffer<"u"?Buffer.from(r).toString("base64"):btoa(r)}_getFinalPath(r){return`${this.bucketId}/${r}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(r){const e=[];return r.width&&e.push(`width=${r.width}`),r.height&&e.push(`height=${r.height}`),r.resize&&e.push(`resize=${r.resize}`),r.format&&e.push(`format=${r.format}`),r.quality&&e.push(`quality=${r.quality}`),e.join("&")}}const cr={"X-Client-Info":"storage-js/2.7.1"};var _e=function(s,r,e,t){return new(e||(e=Promise))(function(i,o){function a(c){try{d(t.next(c))}catch(h){o(h)}}function l(c){try{d(t.throw(c))}catch(h){o(h)}}function d(c){c.done?i(c.value):function n(i){return i instanceof e?i:new e(function(o){o(i)})}(c.value).then(a,l)}d((t=t.apply(s,r||[])).next())})};class ur{constructor(r,e={},t){this.url=r,this.headers=Object.assign(Object.assign({},cr),e),this.fetch=_t(t)}listBuckets(){return _e(this,void 0,void 0,function*(){try{return{data:yield Ee(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){if(q(r))return{data:null,error:r};throw r}})}getBucket(r){return _e(this,void 0,void 0,function*(){try{return{data:yield Ee(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(e){if(q(e))return{data:null,error:e};throw e}})}createBucket(r,e={public:!1}){return _e(this,void 0,void 0,function*(){try{return{data:yield se(this.fetch,`${this.url}/bucket`,{id:r,name:r,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(q(t))return{data:null,error:t};throw t}})}updateBucket(r,e){return _e(this,void 0,void 0,function*(){try{return{data:yield ir(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:e.public,file_size_limit:e.fileSizeLimit,allowed_mime_types:e.allowedMimeTypes},{headers:this.headers}),error:null}}catch(t){if(q(t))return{data:null,error:t};throw t}})}emptyBucket(r){return _e(this,void 0,void 0,function*(){try{return{data:yield se(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(e){if(q(e))return{data:null,error:e};throw e}})}deleteBucket(r){return _e(this,void 0,void 0,function*(){try{return{data:yield vt(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(e){if(q(e))return{data:null,error:e};throw e}})}}class dr extends ur{constructor(r,e={},t){super(r,e,t)}from(r){return new lr(this.url,this.headers,r,this.fetch)}}let Se="";Se=typeof Deno<"u"?"deno":typeof document<"u"?"web":typeof navigator<"u"&&"ReactNative"===navigator.product?"react-native":"node";const fr={headers:{"X-Client-Info":`supabase-js-${Se}/2.50.3`}},gr={schema:"public"},pr={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},_r={};var mt=b(5286);const br=(s,r,e)=>{const t=(s=>{let r;return r=s||(typeof fetch>"u"?mt.default:fetch),(...e)=>r(...e)})(e),n=typeof Headers>"u"?mt.Headers:Headers;return(i,o)=>function(s,r,e,t){return new(e||(e=Promise))(function(i,o){function a(c){try{d(t.next(c))}catch(h){o(h)}}function l(c){try{d(t.throw(c))}catch(h){o(h)}}function d(c){c.done?i(c.value):function n(i){return i instanceof e?i:new e(function(o){o(i)})}(c.value).then(a,l)}d((t=t.apply(s,r||[])).next())})}(void 0,void 0,void 0,function*(){var a;const l=null!==(a=yield r())&&void 0!==a?a:s;let d=new n(null==o?void 0:o.headers);return d.has("apikey")||d.set("apikey",s),d.has("Authorization")||d.set("Authorization",`Bearer ${l}`),t(i,Object.assign(Object.assign({},o),{headers:d}))})};const ve=3e4,Je="X-Supabase-Api-Version",wt={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},Tr=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class He extends Error{constructor(r,e,t){super(r),this.__isAuthError=!0,this.name="AuthError",this.status=e,this.code=t}}function O(s){return"object"==typeof s&&null!==s&&"__isAuthError"in s}class jr extends He{constructor(r,e,t){super(r,e,t),this.name="AuthApiError",this.status=e,this.code=t}}class kt extends He{constructor(r,e){super(r),this.name="AuthUnknownError",this.originalError=e}}class ie extends He{constructor(r,e,t,n){super(r,t,n),this.name=e,this.status=t}}class oe extends ie{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class je extends ie{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class xe extends ie{constructor(r){super(r,"AuthInvalidCredentialsError",400,void 0)}}class Ce extends ie{constructor(r,e=null){super(r,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class At extends ie{constructor(r,e=null){super(r,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=e}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ke extends ie{constructor(r,e){super(r,"AuthRetryableFetchError",e,void 0)}}function Ve(s){return O(s)&&"AuthRetryableFetchError"===s.name}class St extends ie{constructor(r,e,t){super(r,"AuthWeakPasswordError",e,"weak_password"),this.reasons=t}}class Oe extends ie{constructor(r){super(r,"AuthInvalidJwtError",400,"invalid_jwt")}}const Re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Ot=" \t\n\r=".split(""),$r=(()=>{const s=new Array(128);for(let r=0;r<s.length;r+=1)s[r]=-1;for(let r=0;r<Ot.length;r+=1)s[Ot[r].charCodeAt(0)]=-2;for(let r=0;r<Re.length;r+=1)s[Re[r].charCodeAt(0)]=r;return s})();function $e(s,r,e){if(null!==s)for(r.queue=r.queue<<8|s,r.queuedBits+=8;r.queuedBits>=6;)e(Re[r.queue>>r.queuedBits-6&63]),r.queuedBits-=6;else if(r.queuedBits>0)for(r.queue=r.queue<<6-r.queuedBits,r.queuedBits=6;r.queuedBits>=6;)e(Re[r.queue>>r.queuedBits-6&63]),r.queuedBits-=6}function Pt(s,r,e){const t=$r[s];if(!(t>-1)){if(-2===t)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(s)}"`)}for(r.queue=r.queue<<6|t,r.queuedBits+=6;r.queuedBits>=8;)e(r.queue>>r.queuedBits-8&255),r.queuedBits-=8}function Tt(s){const r=[],e=o=>{r.push(String.fromCodePoint(o))},t={utf8seq:0,codepoint:0},n={queue:0,queuedBits:0},i=o=>{!function Ur(s,r,e){if(0===r.utf8seq){if(s<=127)return void e(s);for(let t=1;t<6;t+=1)if(!(s>>7-t&1)){r.utf8seq=t;break}if(2===r.utf8seq)r.codepoint=31&s;else if(3===r.utf8seq)r.codepoint=15&s;else{if(4!==r.utf8seq)throw new Error("Invalid UTF-8 sequence");r.codepoint=7&s}r.utf8seq-=1}else if(r.utf8seq>0){if(s<=127)throw new Error("Invalid UTF-8 sequence");r.codepoint=r.codepoint<<6|63&s,r.utf8seq-=1,0===r.utf8seq&&e(r.codepoint)}}(o,t,e)};for(let o=0;o<s.length;o+=1)Pt(s.charCodeAt(o),n,i);return r.join("")}function Ir(s,r){if(!(s<=127)){if(s<=2047)return r(192|s>>6),void r(128|63&s);if(s<=65535)return r(224|s>>12),r(128|s>>6&63),void r(128|63&s);if(s<=1114111)return r(240|s>>18),r(128|s>>12&63),r(128|s>>6&63),void r(128|63&s);throw new Error(`Unrecognized Unicode codepoint: ${s.toString(16)}`)}r(s)}function Lr(s){const r=[],e={queue:0,queuedBits:0},t=n=>{r.push(n)};for(let n=0;n<s.length;n+=1)Pt(s.charCodeAt(n),e,t);return new Uint8Array(r)}function Dr(s){const r=[],e={queue:0,queuedBits:0},t=n=>{r.push(n)};return s.forEach(n=>$e(n,e,t)),$e(null,e,t),r.join("")}const Y=()=>typeof window<"u"&&typeof document<"u",de={tested:!1,writable:!1},Pe=()=>{if(!Y())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch{return!1}if(de.tested)return de.writable;const s=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(s,s),globalThis.localStorage.removeItem(s),de.tested=!0,de.writable=!0}catch{de.tested=!0,de.writable=!1}return de.writable},jt=s=>{let r;return r=s||(typeof fetch>"u"?(...e)=>Promise.resolve().then(b.bind(b,5286)).then(({default:t})=>t(...e)):fetch),(...e)=>r(...e)},qr=s=>"object"==typeof s&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"==typeof s.json,xt=function(){var s=(0,f.A)(function*(r,e,t){yield r.setItem(e,JSON.stringify(t))});return function(e,t,n){return s.apply(this,arguments)}}(),Ie=function(){var s=(0,f.A)(function*(r,e){const t=yield r.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}});return function(e,t){return s.apply(this,arguments)}}(),Ue=function(){var s=(0,f.A)(function*(r,e){yield r.removeItem(e)});return function(e,t){return s.apply(this,arguments)}}();class Le{constructor(){this.promise=new Le.promiseConstructor((r,e)=>{this.resolve=r,this.reject=e})}}function Qe(s){const r=s.split(".");if(3!==r.length)throw new Oe("Invalid JWT structure");for(let t=0;t<r.length;t++)if(!Tr.test(r[t]))throw new Oe("JWT not in base64url format");return{header:JSON.parse(Tt(r[0])),payload:JSON.parse(Tt(r[1])),signature:Lr(r[2]),raw:{header:r[0],payload:r[1]}}}function Xe(){return(Xe=(0,f.A)(function*(s){return yield new Promise(r=>{setTimeout(()=>r(null),s)})})).apply(this,arguments)}function Gr(s){return("0"+s.toString(16)).substr(-2)}function Ye(){return(Ye=(0,f.A)(function*(s){const e=(new TextEncoder).encode(s),t=yield crypto.subtle.digest("SHA-256",e),n=new Uint8Array(t);return Array.from(n).map(i=>String.fromCharCode(i)).join("")})).apply(this,arguments)}function Ze(){return Ze=(0,f.A)(function*(s){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),s;const e=yield function Hr(s){return Ye.apply(this,arguments)}(s);return btoa(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}),Ze.apply(this,arguments)}function ye(s,r){return et.apply(this,arguments)}function et(){return et=(0,f.A)(function*(s,r,e=!1){const t=function Jr(){const r=new Uint32Array(56);if(typeof crypto>"u"){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let n="";for(let i=0;i<56;i++)n+=e.charAt(Math.floor(Math.random()*t));return n}return crypto.getRandomValues(r),Array.from(r,Gr).join("")}();let n=t;e&&(n+="/PASSWORD_RECOVERY"),yield xt(s,`${r}-code-verifier`,n);const i=yield function Kr(s){return Ze.apply(this,arguments)}(t);return[i,t===i?"plain":"s256"]}),et.apply(this,arguments)}Le.promiseConstructor=Promise;const Vr=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,Zr=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function me(s){if(!Zr.test(s))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}const he=s=>s.msg||s.message||s.error_description||s.error||JSON.stringify(s),tn=[502,503,504];function Ct(s){return tt.apply(this,arguments)}function tt(){return(tt=(0,f.A)(function*(s){var r;if(!qr(s))throw new Ke(he(s),0);if(tn.includes(s.status))throw new Ke(he(s),s.status);let e,t;try{e=yield s.json()}catch(i){throw new kt(he(i),i)}const n=function Qr(s){const r=s.headers.get(Je);if(!r||!r.match(Vr))return null;try{return new Date(`${r}T00:00:00.0Z`)}catch{return null}}(s);if(n&&n.getTime()>=wt["2024-01-01"].timestamp&&"object"==typeof e&&e&&"string"==typeof e.code?t=e.code:"object"==typeof e&&e&&"string"==typeof e.error_code&&(t=e.error_code),t){if("weak_password"===t)throw new St(he(e),s.status,(null===(r=e.weak_password)||void 0===r?void 0:r.reasons)||[]);if("session_not_found"===t)throw new oe}else if("object"==typeof e&&e&&"object"==typeof e.weak_password&&e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.reasons.reduce((i,o)=>i&&"string"==typeof o,!0))throw new St(he(e),s.status,e.weak_password.reasons);throw new jr(he(e),s.status||500,t)})).apply(this,arguments)}const rn=(s,r,e,t)=>{const n={method:s,headers:(null==r?void 0:r.headers)||{}};return"GET"===s?n:(n.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==r?void 0:r.headers),n.body=JSON.stringify(t),Object.assign(Object.assign({},n),e))};function E(s,r,e,t){return rt.apply(this,arguments)}function rt(){return rt=(0,f.A)(function*(s,r,e,t){var n;const i=Object.assign({},null==t?void 0:t.headers);i[Je]||(i[Je]=wt["2024-01-01"].name),null!=t&&t.jwt&&(i.Authorization=`Bearer ${t.jwt}`);const o=null!==(n=null==t?void 0:t.query)&&void 0!==n?n:{};null!=t&&t.redirectTo&&(o.redirect_to=t.redirectTo);const a=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",l=yield function nn(s,r,e,t,n,i){return nt.apply(this,arguments)}(s,r,e+a,{headers:i,noResolveJson:null==t?void 0:t.noResolveJson},{},null==t?void 0:t.body);return null!=t&&t.xform?null==t?void 0:t.xform(l):{data:Object.assign({},l),error:null}}),rt.apply(this,arguments)}function nt(){return(nt=(0,f.A)(function*(s,r,e,t,n,i){const o=rn(r,t,n,i);let a;try{a=yield s(e,Object.assign({},o))}catch(l){throw console.error(l),new Ke(he(l),0)}if(a.ok||(yield Ct(a)),null!=t&&t.noResolveJson)return a;try{return yield a.json()}catch(l){yield Ct(l)}})).apply(this,arguments)}function re(s){var r;let e=null;return function ln(s){return s.access_token&&s.refresh_token&&s.expires_in}(s)&&(e=Object.assign({},s),s.expires_at||(e.expires_at=function Fr(s){return Math.round(Date.now()/1e3)+s}(s.expires_in))),{data:{session:e,user:null!==(r=s.user)&&void 0!==r?r:s},error:null}}function Rt(s){const r=re(s);return!r.error&&s.weak_password&&"object"==typeof s.weak_password&&Array.isArray(s.weak_password.reasons)&&s.weak_password.reasons.length&&s.weak_password.message&&"string"==typeof s.weak_password.message&&s.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(r.data.weak_password=s.weak_password),r}function ae(s){var r;return{data:{user:null!==(r=s.user)&&void 0!==r?r:s},error:null}}function sn(s){return{data:s,error:null}}function on(s){const{action_link:r,email_otp:e,hashed_token:t,redirect_to:n,verification_type:i}=s,o=function(s,r){var e={};for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&r.indexOf(t)<0&&(e[t]=s[t]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(t=Object.getOwnPropertySymbols(s);n<t.length;n++)r.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(s,t[n])&&(e[t[n]]=s[t[n]])}return e}(s,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:r,email_otp:e,hashed_token:t,redirect_to:n,verification_type:i},user:Object.assign({},o)},error:null}}function an(s){return s}const st=["global","local","others"];class un{constructor({url:r="",headers:e={},fetch:t}){this.url=r,this.headers=e,this.fetch=jt(t),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}signOut(r){var e=this;return(0,f.A)(function*(t,n=st[0]){if(st.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${st.join(", ")}`);try{return yield E(e.fetch,"POST",`${e.url}/logout?scope=${n}`,{headers:e.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(i){if(O(i))return{data:null,error:i};throw i}}).apply(this,arguments)}inviteUserByEmail(r){var e=this;return(0,f.A)(function*(t,n={}){try{return yield E(e.fetch,"POST",`${e.url}/invite`,{body:{email:t,data:n.data},headers:e.headers,redirectTo:n.redirectTo,xform:ae})}catch(i){if(O(i))return{data:{user:null},error:i};throw i}}).apply(this,arguments)}generateLink(r){var e=this;return(0,f.A)(function*(){try{const{options:t}=r,n=function(s,r){var e={};for(var t in s)Object.prototype.hasOwnProperty.call(s,t)&&r.indexOf(t)<0&&(e[t]=s[t]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(t=Object.getOwnPropertySymbols(s);n<t.length;n++)r.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(s,t[n])&&(e[t[n]]=s[t[n]])}return e}(r,["options"]),i=Object.assign(Object.assign({},n),t);return"newEmail"in n&&(i.new_email=null==n?void 0:n.newEmail,delete i.newEmail),yield E(e.fetch,"POST",`${e.url}/admin/generate_link`,{body:i,headers:e.headers,xform:on,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(O(t))return{data:{properties:null,user:null},error:t};throw t}})()}createUser(r){var e=this;return(0,f.A)(function*(){try{return yield E(e.fetch,"POST",`${e.url}/admin/users`,{body:r,headers:e.headers,xform:ae})}catch(t){if(O(t))return{data:{user:null},error:t};throw t}})()}listUsers(r){var e=this;return(0,f.A)(function*(){var t,n,i,o,a,l,d;try{const c={nextPage:null,lastPage:0,total:0},h=yield E(e.fetch,"GET",`${e.url}/admin/users`,{headers:e.headers,noResolveJson:!0,query:{page:null!==(n=null===(t=null==r?void 0:r.page)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",per_page:null!==(o=null===(i=null==r?void 0:r.perPage)||void 0===i?void 0:i.toString())&&void 0!==o?o:""},xform:an});if(h.error)throw h.error;const _=yield h.json(),m=null!==(a=h.headers.get("x-total-count"))&&void 0!==a?a:0,v=null!==(d=null===(l=h.headers.get("link"))||void 0===l?void 0:l.split(","))&&void 0!==d?d:[];return v.length>0&&(v.forEach(x=>{const S=parseInt(x.split(";")[0].split("=")[1].substring(0,1)),D=JSON.parse(x.split(";")[1].split("=")[1]);c[`${D}Page`]=S}),c.total=parseInt(m)),{data:Object.assign(Object.assign({},_),c),error:null}}catch(c){if(O(c))return{data:{users:[]},error:c};throw c}})()}getUserById(r){var e=this;return(0,f.A)(function*(){me(r);try{return yield E(e.fetch,"GET",`${e.url}/admin/users/${r}`,{headers:e.headers,xform:ae})}catch(t){if(O(t))return{data:{user:null},error:t};throw t}})()}updateUserById(r,e){var t=this;return(0,f.A)(function*(){me(r);try{return yield E(t.fetch,"PUT",`${t.url}/admin/users/${r}`,{body:e,headers:t.headers,xform:ae})}catch(n){if(O(n))return{data:{user:null},error:n};throw n}})()}deleteUser(r){var e=this;return(0,f.A)(function*(t,n=!1){me(t);try{return yield E(e.fetch,"DELETE",`${e.url}/admin/users/${t}`,{headers:e.headers,body:{should_soft_delete:n},xform:ae})}catch(i){if(O(i))return{data:{user:null},error:i};throw i}}).apply(this,arguments)}_listFactors(r){var e=this;return(0,f.A)(function*(){me(r.userId);try{const{data:t,error:n}=yield E(e.fetch,"GET",`${e.url}/admin/users/${r.userId}/factors`,{headers:e.headers,xform:i=>({data:{factors:i},error:null})});return{data:t,error:n}}catch(t){if(O(t))return{data:null,error:t};throw t}})()}_deleteFactor(r){var e=this;return(0,f.A)(function*(){me(r.userId),me(r.id);try{return{data:yield E(e.fetch,"DELETE",`${e.url}/admin/users/${r.userId}/factors/${r.id}`,{headers:e.headers}),error:null}}catch(t){if(O(t))return{data:null,error:t};throw t}})()}}const dn={getItem:s=>Pe()?globalThis.localStorage.getItem(s):null,setItem:(s,r)=>{Pe()&&globalThis.localStorage.setItem(s,r)},removeItem:s=>{Pe()&&globalThis.localStorage.removeItem(s)}};function $t(s={}){return{getItem:r=>s[r]||null,setItem:(r,e)=>{s[r]=e},removeItem:r=>{delete s[r]}}}const be={debug:!!(globalThis&&Pe()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class It extends Error{constructor(r){super(r),this.isAcquireTimeout=!0}}class fn extends It{}function pn(s,r,e){return it.apply(this,arguments)}function it(){return it=(0,f.A)(function*(s,r,e){be.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",s,r);const t=new globalThis.AbortController;return r>0&&setTimeout(()=>{t.abort(),be.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",s)},r),yield Promise.resolve().then(()=>globalThis.navigator.locks.request(s,0===r?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:t.signal},function(){var n=(0,f.A)(function*(i){if(!i){if(0===r)throw be.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",s),new fn(`Acquiring an exclusive Navigator LockManager lock "${s}" immediately failed`);if(be.debug)try{const o=yield globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(o,null,"  "))}catch(o){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",o)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),yield e()}be.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",s,i.name);try{return yield e()}finally{be.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",s,i.name)}});return function(i){return n.apply(this,arguments)}}()))}),it.apply(this,arguments)}!function hn(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}();const _n={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:{"X-Client-Info":"gotrue-js/2.70.0"},flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};function Lt(s,r,e){return at.apply(this,arguments)}function at(){return(at=(0,f.A)(function*(s,r,e){return yield e()})).apply(this,arguments)}const yn=(()=>{class s{constructor(e){var n,i,t=this;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=s.nextInstanceID,s.nextInstanceID+=1,this.instanceID>0&&Y()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},_n),e);if(this.logDebugMessages=!!o.debug,"function"==typeof o.debug&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new un({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=jt(o.fetch),this.lock=o.lock||Lt,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,this.lock=o.lock?o.lock:Y()&&null!==(n=null==globalThis?void 0:globalThis.navigator)&&void 0!==n&&n.locks?pn:Lt,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?o.storage?this.storage=o.storage:Pe()?this.storage=dn:(this.memoryStorage={},this.storage=$t(this.memoryStorage)):(this.memoryStorage={},this.storage=$t(this.memoryStorage)),Y()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",a)}null===(i=this.broadcastChannel)||void 0===i||i.addEventListener("message",function(){var a=(0,f.A)(function*(l){t._debug("received broadcast notification from other tab or client",l),yield t._notifyAllSubscribers(l.data.event,l.data.session,!1)});return function(l){return a.apply(this,arguments)}}())}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (2.70.0) ${(new Date).toISOString()}`,...e),this}initialize(){var e=this;return(0,f.A)(function*(){return e.initializePromise||(e.initializePromise=(0,f.A)(function*(){return yield e._acquireLock(-1,(0,f.A)(function*(){return yield e._initialize()}))})()),yield e.initializePromise})()}_initialize(){var e=this;return(0,f.A)(function*(){var t;try{const n=function Nr(s){const r={},e=new URL(s);if(e.hash&&"#"===e.hash[0])try{new URLSearchParams(e.hash.substring(1)).forEach((n,i)=>{r[i]=n})}catch{}return e.searchParams.forEach((t,n)=>{r[n]=t}),r}(window.location.href);let i="none";if(e._isImplicitGrantCallback(n)?i="implicit":(yield e._isPKCECallback(n))&&(i="pkce"),Y()&&e.detectSessionInUrl&&"none"!==i){const{data:o,error:a}=yield e._getSessionFromURL(n,i);if(a){if(e._debug("#_initialize()","error detecting session from URL",a),function Rr(s){return O(s)&&"AuthImplicitGrantRedirectError"===s.name}(a)){const c=null===(t=a.details)||void 0===t?void 0:t.code;if("identity_already_exists"===c||"identity_not_found"===c||"single_identity_not_deletable"===c)return{error:a}}return yield e._removeSession(),{error:a}}const{session:l,redirectType:d}=o;return e._debug("#_initialize()","detected session in URL",l,"redirect type",d),yield e._saveSession(l),setTimeout((0,f.A)(function*(){"recovery"===d?yield e._notifyAllSubscribers("PASSWORD_RECOVERY",l):yield e._notifyAllSubscribers("SIGNED_IN",l)}),0),{error:null}}return yield e._recoverAndRefresh(),{error:null}}catch(n){return O(n)?{error:n}:{error:new kt("Unexpected error during initialization",n)}}finally{yield e._handleVisibilityChange(),e._debug("#_initialize()","end")}})()}signInAnonymously(e){var t=this;return(0,f.A)(function*(){var n,i,o;try{const a=yield E(t.fetch,"POST",`${t.url}/signup`,{headers:t.headers,body:{data:null!==(i=null===(n=null==e?void 0:e.options)||void 0===n?void 0:n.data)&&void 0!==i?i:{},gotrue_meta_security:{captcha_token:null===(o=null==e?void 0:e.options)||void 0===o?void 0:o.captchaToken}},xform:re}),{data:l,error:d}=a;if(d||!l)return{data:{user:null,session:null},error:d};const c=l.session,h=l.user;return l.session&&(yield t._saveSession(l.session),yield t._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:h,session:c},error:null}}catch(a){if(O(a))return{data:{user:null,session:null},error:a};throw a}})()}signUp(e){var t=this;return(0,f.A)(function*(){var n,i,o;try{let a;if("email"in e){const{email:_,password:m,options:v}=e;let x=null,S=null;"pkce"===t.flowType&&([x,S]=yield ye(t.storage,t.storageKey)),a=yield E(t.fetch,"POST",`${t.url}/signup`,{headers:t.headers,redirectTo:null==v?void 0:v.emailRedirectTo,body:{email:_,password:m,data:null!==(n=null==v?void 0:v.data)&&void 0!==n?n:{},gotrue_meta_security:{captcha_token:null==v?void 0:v.captchaToken},code_challenge:x,code_challenge_method:S},xform:re})}else{if(!("phone"in e))throw new xe("You must provide either an email or phone number and a password");{const{phone:_,password:m,options:v}=e;a=yield E(t.fetch,"POST",`${t.url}/signup`,{headers:t.headers,body:{phone:_,password:m,data:null!==(i=null==v?void 0:v.data)&&void 0!==i?i:{},channel:null!==(o=null==v?void 0:v.channel)&&void 0!==o?o:"sms",gotrue_meta_security:{captcha_token:null==v?void 0:v.captchaToken}},xform:re})}}const{data:l,error:d}=a;if(d||!l)return{data:{user:null,session:null},error:d};const c=l.session,h=l.user;return l.session&&(yield t._saveSession(l.session),yield t._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:h,session:c},error:null}}catch(a){if(O(a))return{data:{user:null,session:null},error:a};throw a}})()}signInWithPassword(e){var t=this;return(0,f.A)(function*(){try{let n;if("email"in e){const{email:a,password:l,options:d}=e;n=yield E(t.fetch,"POST",`${t.url}/token?grant_type=password`,{headers:t.headers,body:{email:a,password:l,gotrue_meta_security:{captcha_token:null==d?void 0:d.captchaToken}},xform:Rt})}else{if(!("phone"in e))throw new xe("You must provide either an email or phone number and a password");{const{phone:a,password:l,options:d}=e;n=yield E(t.fetch,"POST",`${t.url}/token?grant_type=password`,{headers:t.headers,body:{phone:a,password:l,gotrue_meta_security:{captcha_token:null==d?void 0:d.captchaToken}},xform:Rt})}}const{data:i,error:o}=n;return o?{data:{user:null,session:null},error:o}:i&&i.session&&i.user?(i.session&&(yield t._saveSession(i.session),yield t._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign({user:i.user,session:i.session},i.weak_password?{weakPassword:i.weak_password}:null),error:o}):{data:{user:null,session:null},error:new je}}catch(n){if(O(n))return{data:{user:null,session:null},error:n};throw n}})()}signInWithOAuth(e){var t=this;return(0,f.A)(function*(){var n,i,o,a;return yield t._handleProviderSignIn(e.provider,{redirectTo:null===(n=e.options)||void 0===n?void 0:n.redirectTo,scopes:null===(i=e.options)||void 0===i?void 0:i.scopes,queryParams:null===(o=e.options)||void 0===o?void 0:o.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})})()}exchangeCodeForSession(e){var t=this;return(0,f.A)(function*(){return yield t.initializePromise,t._acquireLock(-1,(0,f.A)(function*(){return t._exchangeCodeForSession(e)}))})()}signInWithWeb3(e){var t=this;return(0,f.A)(function*(){const{chain:n}=e;if("solana"===n)return yield t.signInWithSolana(e);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)})()}signInWithSolana(e){var t=this;return(0,f.A)(function*(){var n,i,o,a,l,d,c,h,_,m,v,x;let S,D;if("message"in e)S=e.message,D=e.signature;else{const{wallet:W,statement:K,options:A}=e;let N;if(Y())if("object"==typeof W)N=W;else{const F=window;if(!("solana"in F)||"object"!=typeof F.solana||!("signIn"in F.solana&&"function"==typeof F.solana.signIn||"signMessage"in F.solana&&"function"==typeof F.solana.signMessage))throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.");N=F.solana}else{if("object"!=typeof W||null==A||!A.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");N=W}const Z=new URL(null!==(n=null==A?void 0:A.url)&&void 0!==n?n:window.location.href);if("signIn"in N&&N.signIn){const F=yield N.signIn(Object.assign(Object.assign(Object.assign({issuedAt:(new Date).toISOString()},null==A?void 0:A.signInWithSolana),{version:"1",domain:Z.host,uri:Z.href}),K?{statement:K}:null));let Q;if(Array.isArray(F)&&F[0]&&"object"==typeof F[0])Q=F[0];else{if(!(F&&"object"==typeof F&&"signedMessage"in F&&"signature"in F))throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");Q=F}if(!("signedMessage"in Q&&"signature"in Q&&("string"==typeof Q.signedMessage||Q.signedMessage instanceof Uint8Array)&&Q.signature instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields");S="string"==typeof Q.signedMessage?Q.signedMessage:(new TextDecoder).decode(Q.signedMessage),D=Q.signature}else{if(!("signMessage"in N&&"function"==typeof N.signMessage&&"publicKey"in N&&"object"==typeof N&&N.publicKey&&"toBase58"in N.publicKey&&"function"==typeof N.publicKey.toBase58))throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");S=[`${Z.host} wants you to sign in with your Solana account:`,N.publicKey.toBase58(),...K?["",K,""]:[""],"Version: 1",`URI: ${Z.href}`,`Issued At: ${null!==(o=null===(i=null==A?void 0:A.signInWithSolana)||void 0===i?void 0:i.issuedAt)&&void 0!==o?o:(new Date).toISOString()}`,...null!==(a=null==A?void 0:A.signInWithSolana)&&void 0!==a&&a.notBefore?[`Not Before: ${A.signInWithSolana.notBefore}`]:[],...null!==(l=null==A?void 0:A.signInWithSolana)&&void 0!==l&&l.expirationTime?[`Expiration Time: ${A.signInWithSolana.expirationTime}`]:[],...null!==(d=null==A?void 0:A.signInWithSolana)&&void 0!==d&&d.chainId?[`Chain ID: ${A.signInWithSolana.chainId}`]:[],...null!==(c=null==A?void 0:A.signInWithSolana)&&void 0!==c&&c.nonce?[`Nonce: ${A.signInWithSolana.nonce}`]:[],...null!==(h=null==A?void 0:A.signInWithSolana)&&void 0!==h&&h.requestId?[`Request ID: ${A.signInWithSolana.requestId}`]:[],...null!==(m=null===(_=null==A?void 0:A.signInWithSolana)||void 0===_?void 0:_.resources)&&void 0!==m&&m.length?["Resources",...A.signInWithSolana.resources.map(Q=>`- ${Q}`)]:[]].join("\n");const F=yield N.signMessage((new TextEncoder).encode(S),"utf8");if(!(F&&F instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");D=F}}try{const{data:M,error:W}=yield E(t.fetch,"POST",`${t.url}/token?grant_type=web3`,{headers:t.headers,body:Object.assign({chain:"solana",message:S,signature:Dr(D)},null!==(v=e.options)&&void 0!==v&&v.captchaToken?{gotrue_meta_security:{captcha_token:null===(x=e.options)||void 0===x?void 0:x.captchaToken}}:null),xform:re});if(W)throw W;return M&&M.session&&M.user?(M.session&&(yield t._saveSession(M.session),yield t._notifyAllSubscribers("SIGNED_IN",M.session)),{data:Object.assign({},M),error:W}):{data:{user:null,session:null},error:new je}}catch(M){if(O(M))return{data:{user:null,session:null},error:M};throw M}})()}_exchangeCodeForSession(e){var t=this;return(0,f.A)(function*(){const n=yield Ie(t.storage,`${t.storageKey}-code-verifier`),[i,o]=(null!=n?n:"").split("/");try{const{data:a,error:l}=yield E(t.fetch,"POST",`${t.url}/token?grant_type=pkce`,{headers:t.headers,body:{auth_code:e,code_verifier:i},xform:re});if(yield Ue(t.storage,`${t.storageKey}-code-verifier`),l)throw l;return a&&a.session&&a.user?(a.session&&(yield t._saveSession(a.session),yield t._notifyAllSubscribers("SIGNED_IN",a.session)),{data:Object.assign(Object.assign({},a),{redirectType:null!=o?o:null}),error:l}):{data:{user:null,session:null,redirectType:null},error:new je}}catch(a){if(O(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}})()}signInWithIdToken(e){var t=this;return(0,f.A)(function*(){try{const{options:n,provider:i,token:o,access_token:a,nonce:l}=e,d=yield E(t.fetch,"POST",`${t.url}/token?grant_type=id_token`,{headers:t.headers,body:{provider:i,id_token:o,access_token:a,nonce:l,gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:re}),{data:c,error:h}=d;return h?{data:{user:null,session:null},error:h}:c&&c.session&&c.user?(c.session&&(yield t._saveSession(c.session),yield t._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:h}):{data:{user:null,session:null},error:new je}}catch(n){if(O(n))return{data:{user:null,session:null},error:n};throw n}})()}signInWithOtp(e){var t=this;return(0,f.A)(function*(){var n,i,o,a,l;try{if("email"in e){const{email:d,options:c}=e;let h=null,_=null;"pkce"===t.flowType&&([h,_]=yield ye(t.storage,t.storageKey));const{error:m}=yield E(t.fetch,"POST",`${t.url}/otp`,{headers:t.headers,body:{email:d,data:null!==(n=null==c?void 0:c.data)&&void 0!==n?n:{},create_user:null===(i=null==c?void 0:c.shouldCreateUser)||void 0===i||i,gotrue_meta_security:{captcha_token:null==c?void 0:c.captchaToken},code_challenge:h,code_challenge_method:_},redirectTo:null==c?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:m}}if("phone"in e){const{phone:d,options:c}=e,{data:h,error:_}=yield E(t.fetch,"POST",`${t.url}/otp`,{headers:t.headers,body:{phone:d,data:null!==(o=null==c?void 0:c.data)&&void 0!==o?o:{},create_user:null===(a=null==c?void 0:c.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null==c?void 0:c.captchaToken},channel:null!==(l=null==c?void 0:c.channel)&&void 0!==l?l:"sms"}});return{data:{user:null,session:null,messageId:null==h?void 0:h.message_id},error:_}}throw new xe("You must provide either an email or phone number.")}catch(d){if(O(d))return{data:{user:null,session:null},error:d};throw d}})()}verifyOtp(e){var t=this;return(0,f.A)(function*(){var n,i;try{let o,a;"options"in e&&(o=null===(n=e.options)||void 0===n?void 0:n.redirectTo,a=null===(i=e.options)||void 0===i?void 0:i.captchaToken);const{data:l,error:d}=yield E(t.fetch,"POST",`${t.url}/verify`,{headers:t.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:o,xform:re});if(d)throw d;if(!l)throw new Error("An error occurred on token verification.");const c=l.session,h=l.user;return null!=c&&c.access_token&&(yield t._saveSession(c),yield t._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:h,session:c},error:null}}catch(o){if(O(o))return{data:{user:null,session:null},error:o};throw o}})()}signInWithSSO(e){var t=this;return(0,f.A)(function*(){var n,i,o;try{let a=null,l=null;return"pkce"===t.flowType&&([a,l]=yield ye(t.storage,t.storageKey)),yield E(t.fetch,"POST",`${t.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(i=null===(n=e.options)||void 0===n?void 0:n.redirectTo)&&void 0!==i?i:void 0}),null!==(o=null==e?void 0:e.options)&&void 0!==o&&o.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:l}),headers:t.headers,xform:sn})}catch(a){if(O(a))return{data:null,error:a};throw a}})()}reauthenticate(){var e=this;return(0,f.A)(function*(){return yield e.initializePromise,yield e._acquireLock(-1,(0,f.A)(function*(){return yield e._reauthenticate()}))})()}_reauthenticate(){var e=this;return(0,f.A)(function*(){try{return yield e._useSession(function(){var t=(0,f.A)(function*(n){const{data:{session:i},error:o}=n;if(o)throw o;if(!i)throw new oe;const{error:a}=yield E(e.fetch,"GET",`${e.url}/reauthenticate`,{headers:e.headers,jwt:i.access_token});return{data:{user:null,session:null},error:a}});return function(n){return t.apply(this,arguments)}}())}catch(t){if(O(t))return{data:{user:null,session:null},error:t};throw t}})()}resend(e){var t=this;return(0,f.A)(function*(){try{const n=`${t.url}/resend`;if("email"in e){const{email:i,type:o,options:a}=e,{error:l}=yield E(t.fetch,"POST",n,{headers:t.headers,body:{email:i,type:o,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},redirectTo:null==a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:l}}if("phone"in e){const{phone:i,type:o,options:a}=e,{data:l,error:d}=yield E(t.fetch,"POST",n,{headers:t.headers,body:{phone:i,type:o,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null==l?void 0:l.message_id},error:d}}throw new xe("You must provide either an email or phone number and a type")}catch(n){if(O(n))return{data:{user:null,session:null},error:n};throw n}})()}getSession(){var e=this;return(0,f.A)(function*(){return yield e.initializePromise,yield e._acquireLock(-1,(0,f.A)(function*(){return e._useSession(function(){var n=(0,f.A)(function*(i){return i});return function(i){return n.apply(this,arguments)}}())}))})()}_acquireLock(e,t){var n=this;return(0,f.A)(function*(){n._debug("#_acquireLock","begin",e);try{if(n.lockAcquired){const i=n.pendingInLock.length?n.pendingInLock[n.pendingInLock.length-1]:Promise.resolve(),o=(0,f.A)(function*(){return yield i,yield t()})();return n.pendingInLock.push((0,f.A)(function*(){try{yield o}catch{}})()),o}return yield n.lock(`lock:${n.storageKey}`,e,(0,f.A)(function*(){n._debug("#_acquireLock","lock acquired for storage key",n.storageKey);try{n.lockAcquired=!0;const i=t();for(n.pendingInLock.push((0,f.A)(function*(){try{yield i}catch{}})()),yield i;n.pendingInLock.length;){const o=[...n.pendingInLock];yield Promise.all(o),n.pendingInLock.splice(0,o.length)}return yield i}finally{n._debug("#_acquireLock","lock released for storage key",n.storageKey),n.lockAcquired=!1}}))}finally{n._debug("#_acquireLock","end")}})()}_useSession(e){var t=this;return(0,f.A)(function*(){t._debug("#_useSession","begin");try{const n=yield t.__loadSession();return yield e(n)}finally{t._debug("#_useSession","end")}})()}__loadSession(){var e=this;return(0,f.A)(function*(){e._debug("#__loadSession()","begin"),e.lockAcquired||e._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let t=null;const n=yield Ie(e.storage,e.storageKey);if(e._debug("#getSession()","session from storage",n),null!==n&&(e._isValidSession(n)?t=n:(e._debug("#getSession()","session from storage is not valid"),yield e._removeSession())),!t)return{data:{session:null},error:null};const i=!!t.expires_at&&1e3*t.expires_at-Date.now()<9e4;if(e._debug("#__loadSession()",`session has${i?"":" not"} expired`,"expires_at",t.expires_at),!i){if(e.storage.isServer){let l=e.suppressGetSessionWarning;t=new Proxy(t,{get:(c,h,_)=>(!l&&"user"===h&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),l=!0,e.suppressGetSessionWarning=!0),Reflect.get(c,h,_))})}return{data:{session:t},error:null}}const{session:o,error:a}=yield e._callRefreshToken(t.refresh_token);return a?{data:{session:null},error:a}:{data:{session:o},error:null}}finally{e._debug("#__loadSession()","end")}})()}getUser(e){var t=this;return(0,f.A)(function*(){return e?yield t._getUser(e):(yield t.initializePromise,yield t._acquireLock(-1,(0,f.A)(function*(){return yield t._getUser()})))})()}_getUser(e){var t=this;return(0,f.A)(function*(){try{return e?yield E(t.fetch,"GET",`${t.url}/user`,{headers:t.headers,jwt:e,xform:ae}):yield t._useSession(function(){var n=(0,f.A)(function*(i){var o,a,l;const{data:d,error:c}=i;if(c)throw c;return null!==(o=d.session)&&void 0!==o&&o.access_token||t.hasCustomAuthorizationHeader?yield E(t.fetch,"GET",`${t.url}/user`,{headers:t.headers,jwt:null!==(l=null===(a=d.session)||void 0===a?void 0:a.access_token)&&void 0!==l?l:void 0,xform:ae}):{data:{user:null},error:new oe}});return function(i){return n.apply(this,arguments)}}())}catch(n){if(O(n))return function Cr(s){return O(s)&&"AuthSessionMissingError"===s.name}(n)&&(yield t._removeSession(),yield Ue(t.storage,`${t.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}})()}updateUser(e){var t=this;return(0,f.A)(function*(n,i={}){return yield t.initializePromise,yield t._acquireLock(-1,(0,f.A)(function*(){return yield t._updateUser(n,i)}))}).apply(this,arguments)}_updateUser(e){var t=this;return(0,f.A)(function*(n,i={}){try{return yield t._useSession(function(){var o=(0,f.A)(function*(a){const{data:l,error:d}=a;if(d)throw d;if(!l.session)throw new oe;const c=l.session;let h=null,_=null;"pkce"===t.flowType&&null!=n.email&&([h,_]=yield ye(t.storage,t.storageKey));const{data:m,error:v}=yield E(t.fetch,"PUT",`${t.url}/user`,{headers:t.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:Object.assign(Object.assign({},n),{code_challenge:h,code_challenge_method:_}),jwt:c.access_token,xform:ae});if(v)throw v;return c.user=m.user,yield t._saveSession(c),yield t._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}});return function(a){return o.apply(this,arguments)}}())}catch(o){if(O(o))return{data:{user:null},error:o};throw o}}).apply(this,arguments)}setSession(e){var t=this;return(0,f.A)(function*(){return yield t.initializePromise,yield t._acquireLock(-1,(0,f.A)(function*(){return yield t._setSession(e)}))})()}_setSession(e){var t=this;return(0,f.A)(function*(){try{if(!e.access_token||!e.refresh_token)throw new oe;const n=Date.now()/1e3;let i=n,o=!0,a=null;const{payload:l}=Qe(e.access_token);if(l.exp&&(i=l.exp,o=i<=n),o){const{session:d,error:c}=yield t._callRefreshToken(e.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!d)return{data:{user:null,session:null},error:null};a=d}else{const{data:d,error:c}=yield t._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:d.user,token_type:"bearer",expires_in:i-n,expires_at:i},yield t._saveSession(a),yield t._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(n){if(O(n))return{data:{session:null,user:null},error:n};throw n}})()}refreshSession(e){var t=this;return(0,f.A)(function*(){return yield t.initializePromise,yield t._acquireLock(-1,(0,f.A)(function*(){return yield t._refreshSession(e)}))})()}_refreshSession(e){var t=this;return(0,f.A)(function*(){try{return yield t._useSession(function(){var n=(0,f.A)(function*(i){var o;if(!e){const{data:d,error:c}=i;if(c)throw c;e=null!==(o=d.session)&&void 0!==o?o:void 0}if(null==e||!e.refresh_token)throw new oe;const{session:a,error:l}=yield t._callRefreshToken(e.refresh_token);return l?{data:{user:null,session:null},error:l}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}});return function(i){return n.apply(this,arguments)}}())}catch(n){if(O(n))return{data:{user:null,session:null},error:n};throw n}})()}_getSessionFromURL(e,t){var n=this;return(0,f.A)(function*(){try{if(!Y())throw new Ce("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Ce(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===n.flowType)throw new At("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===n.flowType)throw new Ce("Not a valid implicit grant flow url.")}if("pkce"===t){if(n._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new At("No code detected.");const{data:K,error:A}=yield n._exchangeCodeForSession(e.code);if(A)throw A;const N=new URL(window.location.href);return N.searchParams.delete("code"),window.history.replaceState(window.history.state,"",N.toString()),{data:{session:K.session,redirectType:null},error:null}}const{provider_token:i,provider_refresh_token:o,access_token:a,refresh_token:l,expires_in:d,expires_at:c,token_type:h}=e;if(!(a&&d&&l&&h))throw new Ce("No session defined in URL");const _=Math.round(Date.now()/1e3),m=parseInt(d);let v=_+m;c&&(v=parseInt(c));const x=v-_;1e3*x<=ve&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${x}s, should have been closer to ${m}s`);const S=v-m;_-S>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",S,v,_):_-S<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",S,v,_);const{data:D,error:M}=yield n._getUser(a);if(M)throw M;const W={provider_token:i,provider_refresh_token:o,access_token:a,expires_in:m,expires_at:v,refresh_token:l,token_type:h,user:D.user};return window.location.hash="",n._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:W,redirectType:e.type},error:null}}catch(i){if(O(i))return{data:{session:null,redirectType:null},error:i};throw i}})()}_isImplicitGrantCallback(e){return!(!e.access_token&&!e.error_description)}_isPKCECallback(e){var t=this;return(0,f.A)(function*(){const n=yield Ie(t.storage,`${t.storageKey}-code-verifier`);return!(!e.code||!n)})()}signOut(){var e=this;return(0,f.A)(function*(t={scope:"global"}){return yield e.initializePromise,yield e._acquireLock(-1,(0,f.A)(function*(){return yield e._signOut(t)}))}).apply(this,arguments)}_signOut(){var e=this;return(0,f.A)(function*({scope:t}={scope:"global"}){return yield e._useSession(function(){var n=(0,f.A)(function*(i){var o;const{data:a,error:l}=i;if(l)return{error:l};const d=null===(o=a.session)||void 0===o?void 0:o.access_token;if(d){const{error:c}=yield e.admin.signOut(d,t);if(c&&(!function xr(s){return O(s)&&"AuthApiError"===s.name}(c)||404!==c.status&&401!==c.status&&403!==c.status))return{error:c}}return"others"!==t&&(yield e._removeSession(),yield Ue(e.storage,`${e.storageKey}-code-verifier`)),{error:null}});return function(i){return n.apply(this,arguments)}}())}).apply(this,arguments)}onAuthStateChange(e){var t=this;const n=function Br(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(s){const r=16*Math.random()|0;return("x"==s?r:3&r|8).toString(16)})}(),i={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,i),(0,f.A)(function*(){yield t.initializePromise,yield t._acquireLock(-1,(0,f.A)(function*(){t._emitInitialSession(n)}))})(),{data:{subscription:i}}}_emitInitialSession(e){var t=this;return(0,f.A)(function*(){return yield t._useSession(function(){var n=(0,f.A)(function*(i){var o,a;try{const{data:{session:l},error:d}=i;if(d)throw d;yield null===(o=t.stateChangeEmitters.get(e))||void 0===o?void 0:o.callback("INITIAL_SESSION",l),t._debug("INITIAL_SESSION","callback id",e,"session",l)}catch(l){yield null===(a=t.stateChangeEmitters.get(e))||void 0===a?void 0:a.callback("INITIAL_SESSION",null),t._debug("INITIAL_SESSION","callback id",e,"error",l),console.error(l)}});return function(i){return n.apply(this,arguments)}}())})()}resetPasswordForEmail(e){var t=this;return(0,f.A)(function*(n,i={}){let o=null,a=null;"pkce"===t.flowType&&([o,a]=yield ye(t.storage,t.storageKey,!0));try{return yield E(t.fetch,"POST",`${t.url}/recover`,{body:{email:n,code_challenge:o,code_challenge_method:a,gotrue_meta_security:{captcha_token:i.captchaToken}},headers:t.headers,redirectTo:i.redirectTo})}catch(l){if(O(l))return{data:null,error:l};throw l}}).apply(this,arguments)}getUserIdentities(){var e=this;return(0,f.A)(function*(){var t;try{const{data:n,error:i}=yield e.getUser();if(i)throw i;return{data:{identities:null!==(t=n.user.identities)&&void 0!==t?t:[]},error:null}}catch(n){if(O(n))return{data:null,error:n};throw n}})()}linkIdentity(e){var t=this;return(0,f.A)(function*(){var n;try{const{data:i,error:o}=yield t._useSession(function(){var a=(0,f.A)(function*(l){var d,c,h,_,m;const{data:v,error:x}=l;if(x)throw x;const S=yield t._getUrlForProvider(`${t.url}/user/identities/authorize`,e.provider,{redirectTo:null===(d=e.options)||void 0===d?void 0:d.redirectTo,scopes:null===(c=e.options)||void 0===c?void 0:c.scopes,queryParams:null===(h=e.options)||void 0===h?void 0:h.queryParams,skipBrowserRedirect:!0});return yield E(t.fetch,"GET",S,{headers:t.headers,jwt:null!==(m=null===(_=v.session)||void 0===_?void 0:_.access_token)&&void 0!==m?m:void 0})});return function(l){return a.apply(this,arguments)}}());if(o)throw o;return Y()&&!(null!==(n=e.options)&&void 0!==n&&n.skipBrowserRedirect)&&window.location.assign(null==i?void 0:i.url),{data:{provider:e.provider,url:null==i?void 0:i.url},error:null}}catch(i){if(O(i))return{data:{provider:e.provider,url:null},error:i};throw i}})()}unlinkIdentity(e){var t=this;return(0,f.A)(function*(){try{return yield t._useSession(function(){var n=(0,f.A)(function*(i){var o,a;const{data:l,error:d}=i;if(d)throw d;return yield E(t.fetch,"DELETE",`${t.url}/user/identities/${e.identity_id}`,{headers:t.headers,jwt:null!==(a=null===(o=l.session)||void 0===o?void 0:o.access_token)&&void 0!==a?a:void 0})});return function(i){return n.apply(this,arguments)}}())}catch(n){if(O(n))return{data:null,error:n};throw n}})()}_refreshAccessToken(e){var t=this;return(0,f.A)(function*(){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;t._debug(n,"begin");try{const i=Date.now();return yield function zr(s,r){return new Promise((t,n)=>{(0,f.A)(function*(){for(let i=0;i<1/0;i++)try{const o=yield s(i);if(!r(i,null,o))return void t(o)}catch(o){if(!r(i,o))return void n(o)}})()})}(function(){var o=(0,f.A)(function*(a){return a>0&&(yield function Wr(s){return Xe.apply(this,arguments)}(200*Math.pow(2,a-1))),t._debug(n,"refreshing attempt",a),yield E(t.fetch,"POST",`${t.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:t.headers,xform:re})});return function(a){return o.apply(this,arguments)}}(),(o,a)=>{const l=200*Math.pow(2,o);return a&&Ve(a)&&Date.now()+l-i<ve})}catch(i){if(t._debug(n,"error",i),O(i))return{data:{session:null,user:null},error:i};throw i}finally{t._debug(n,"end")}})()}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}_handleProviderSignIn(e,t){var n=this;return(0,f.A)(function*(){const i=yield n._getUrlForProvider(`${n.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return n._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",i),Y()&&!t.skipBrowserRedirect&&window.location.assign(i),{data:{provider:e,url:i},error:null}})()}_recoverAndRefresh(){var e=this;return(0,f.A)(function*(){var t;const n="#_recoverAndRefresh()";e._debug(n,"begin");try{const i=yield Ie(e.storage,e.storageKey);if(e._debug(n,"session from storage",i),!e._isValidSession(i))return e._debug(n,"session is not valid"),void(null!==i&&(yield e._removeSession()));const o=1e3*(null!==(t=i.expires_at)&&void 0!==t?t:1/0)-Date.now()<9e4;if(e._debug(n,`session has${o?"":" not"} expired with margin of 90000s`),o){if(e.autoRefreshToken&&i.refresh_token){const{error:a}=yield e._callRefreshToken(i.refresh_token);a&&(console.error(a),Ve(a)||(e._debug(n,"refresh failed with a non-retryable error, removing the session",a),yield e._removeSession()))}}else yield e._notifyAllSubscribers("SIGNED_IN",i)}catch(i){return e._debug(n,"error",i),void console.error(i)}finally{e._debug(n,"end")}})()}_callRefreshToken(e){var t=this;return(0,f.A)(function*(){var n,i;if(!e)throw new oe;if(t.refreshingDeferred)return t.refreshingDeferred.promise;const o=`#_callRefreshToken(${e.substring(0,5)}...)`;t._debug(o,"begin");try{t.refreshingDeferred=new Le;const{data:a,error:l}=yield t._refreshAccessToken(e);if(l)throw l;if(!a.session)throw new oe;yield t._saveSession(a.session),yield t._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const d={session:a.session,error:null};return t.refreshingDeferred.resolve(d),d}catch(a){if(t._debug(o,"error",a),O(a)){const l={session:null,error:a};return Ve(a)||(yield t._removeSession()),null===(n=t.refreshingDeferred)||void 0===n||n.resolve(l),l}throw null===(i=t.refreshingDeferred)||void 0===i||i.reject(a),a}finally{t.refreshingDeferred=null,t._debug(o,"end")}})()}_notifyAllSubscribers(e,t){var n=this;return(0,f.A)(function*(i,o,a=!0){const l=`#_notifyAllSubscribers(${i})`;n._debug(l,"begin",o,`broadcast = ${a}`);try{n.broadcastChannel&&a&&n.broadcastChannel.postMessage({event:i,session:o});const d=[],c=Array.from(n.stateChangeEmitters.values()).map(function(){var h=(0,f.A)(function*(_){try{yield _.callback(i,o)}catch(m){d.push(m)}});return function(_){return h.apply(this,arguments)}}());if(yield Promise.all(c),d.length>0){for(let h=0;h<d.length;h+=1)console.error(d[h]);throw d[0]}}finally{n._debug(l,"end")}}).apply(this,arguments)}_saveSession(e){var t=this;return(0,f.A)(function*(){t._debug("#_saveSession()",e),t.suppressGetSessionWarning=!0,yield xt(t.storage,t.storageKey,e)})()}_removeSession(){var e=this;return(0,f.A)(function*(){e._debug("#_removeSession()"),yield Ue(e.storage,e.storageKey),yield e._notifyAllSubscribers("SIGNED_OUT",null)})()}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Y()&&null!=window&&window.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}_startAutoRefresh(){var e=this;return(0,f.A)(function*(){yield e._stopAutoRefresh(),e._debug("#_startAutoRefresh()");const t=setInterval(()=>e._autoRefreshTokenTick(),ve);e.autoRefreshTicker=t,t&&"object"==typeof t&&"function"==typeof t.unref?t.unref():typeof Deno<"u"&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(t),setTimeout((0,f.A)(function*(){yield e.initializePromise,yield e._autoRefreshTokenTick()}),0)})()}_stopAutoRefresh(){var e=this;return(0,f.A)(function*(){e._debug("#_stopAutoRefresh()");const t=e.autoRefreshTicker;e.autoRefreshTicker=null,t&&clearInterval(t)})()}startAutoRefresh(){var e=this;return(0,f.A)(function*(){e._removeVisibilityChangedCallback(),yield e._startAutoRefresh()})()}stopAutoRefresh(){var e=this;return(0,f.A)(function*(){e._removeVisibilityChangedCallback(),yield e._stopAutoRefresh()})()}_autoRefreshTokenTick(){var e=this;return(0,f.A)(function*(){e._debug("#_autoRefreshTokenTick()","begin");try{yield e._acquireLock(0,(0,f.A)(function*(){try{const t=Date.now();try{return yield e._useSession(function(){var n=(0,f.A)(function*(i){const{data:{session:o}}=i;if(!o||!o.refresh_token||!o.expires_at)return void e._debug("#_autoRefreshTokenTick()","no session");const a=Math.floor((1e3*o.expires_at-t)/ve);e._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),a<=3&&(yield e._callRefreshToken(o.refresh_token))});return function(i){return n.apply(this,arguments)}}())}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{e._debug("#_autoRefreshTokenTick()","end")}}))}catch(t){if(!(t.isAcquireTimeout||t instanceof It))throw t;e._debug("auto refresh token tick lock not available")}})()}_handleVisibilityChange(){var e=this;return(0,f.A)(function*(){if(e._debug("#_handleVisibilityChange()"),!Y()||null==window||!window.addEventListener)return e.autoRefreshToken&&e.startAutoRefresh(),!1;try{e.visibilityChangedCallback=(0,f.A)(function*(){return yield e._onVisibilityChanged(!1)}),null==window||window.addEventListener("visibilitychange",e.visibilityChangedCallback),yield e._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}})()}_onVisibilityChanged(e){var t=this;return(0,f.A)(function*(){const n=`#_onVisibilityChanged(${e})`;t._debug(n,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(t.autoRefreshToken&&t._startAutoRefresh(),e||(yield t.initializePromise,yield t._acquireLock(-1,(0,f.A)(function*(){"visible"===document.visibilityState?yield t._recoverAndRefresh():t._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&t.autoRefreshToken&&t._stopAutoRefresh()})()}_getUrlForProvider(e,t,n){var i=this;return(0,f.A)(function*(){const o=[`provider=${encodeURIComponent(t)}`];if(null!=n&&n.redirectTo&&o.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),null!=n&&n.scopes&&o.push(`scopes=${encodeURIComponent(n.scopes)}`),"pkce"===i.flowType){const[a,l]=yield ye(i.storage,i.storageKey),d=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(l)}`});o.push(d.toString())}if(null!=n&&n.queryParams){const a=new URLSearchParams(n.queryParams);o.push(a.toString())}return null!=n&&n.skipBrowserRedirect&&o.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${e}?${o.join("&")}`})()}_unenroll(e){var t=this;return(0,f.A)(function*(){try{return yield t._useSession(function(){var n=(0,f.A)(function*(i){var o;const{data:a,error:l}=i;return l?{data:null,error:l}:yield E(t.fetch,"DELETE",`${t.url}/factors/${e.factorId}`,{headers:t.headers,jwt:null===(o=null==a?void 0:a.session)||void 0===o?void 0:o.access_token})});return function(i){return n.apply(this,arguments)}}())}catch(n){if(O(n))return{data:null,error:n};throw n}})()}_enroll(e){var t=this;return(0,f.A)(function*(){try{return yield t._useSession(function(){var n=(0,f.A)(function*(i){var o,a;const{data:l,error:d}=i;if(d)return{data:null,error:d};const c=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:h,error:_}=yield E(t.fetch,"POST",`${t.url}/factors`,{body:c,headers:t.headers,jwt:null===(o=null==l?void 0:l.session)||void 0===o?void 0:o.access_token});return _?{data:null,error:_}:("totp"===e.factorType&&!(null===(a=null==h?void 0:h.totp)||void 0===a)&&a.qr_code&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})});return function(i){return n.apply(this,arguments)}}())}catch(n){if(O(n))return{data:null,error:n};throw n}})()}_verify(e){var t=this;return(0,f.A)(function*(){return t._acquireLock(-1,(0,f.A)(function*(){try{return yield t._useSession(function(){var n=(0,f.A)(function*(i){var o;const{data:a,error:l}=i;if(l)return{data:null,error:l};const{data:d,error:c}=yield E(t.fetch,"POST",`${t.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:t.headers,jwt:null===(o=null==a?void 0:a.session)||void 0===o?void 0:o.access_token});return c?{data:null,error:c}:(yield t._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+d.expires_in},d)),yield t._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",d),{data:d,error:c})});return function(i){return n.apply(this,arguments)}}())}catch(n){if(O(n))return{data:null,error:n};throw n}}))})()}_challenge(e){var t=this;return(0,f.A)(function*(){return t._acquireLock(-1,(0,f.A)(function*(){try{return yield t._useSession(function(){var n=(0,f.A)(function*(i){var o;const{data:a,error:l}=i;return l?{data:null,error:l}:yield E(t.fetch,"POST",`${t.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:t.headers,jwt:null===(o=null==a?void 0:a.session)||void 0===o?void 0:o.access_token})});return function(i){return n.apply(this,arguments)}}())}catch(n){if(O(n))return{data:null,error:n};throw n}}))})()}_challengeAndVerify(e){var t=this;return(0,f.A)(function*(){const{data:n,error:i}=yield t._challenge({factorId:e.factorId});return i?{data:null,error:i}:yield t._verify({factorId:e.factorId,challengeId:n.id,code:e.code})})()}_listFactors(){var e=this;return(0,f.A)(function*(){const{data:{user:t},error:n}=yield e.getUser();if(n)return{data:null,error:n};const i=(null==t?void 0:t.factors)||[],o=i.filter(l=>"totp"===l.factor_type&&"verified"===l.status),a=i.filter(l=>"phone"===l.factor_type&&"verified"===l.status);return{data:{all:i,totp:o,phone:a},error:null}})()}_getAuthenticatorAssuranceLevel(){var e=this;return(0,f.A)(function*(){return e._acquireLock(-1,(0,f.A)(function*(){return yield e._useSession(function(){var t=(0,f.A)(function*(n){var i,o;const{data:{session:a},error:l}=n;if(l)return{data:null,error:l};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:d}=Qe(a.access_token);let c=null;d.aal&&(c=d.aal);let h=c;return(null!==(o=null===(i=a.user.factors)||void 0===i?void 0:i.filter(v=>"verified"===v.status))&&void 0!==o?o:[]).length>0&&(h="aal2"),{data:{currentLevel:c,nextLevel:h,currentAuthenticationMethods:d.amr||[]},error:null}});return function(n){return t.apply(this,arguments)}}())}))})()}fetchJwk(e){var t=this;return(0,f.A)(function*(n,i={keys:[]}){let o=i.keys.find(d=>d.kid===n);if(o||(o=t.jwks.keys.find(d=>d.kid===n),o&&t.jwks_cached_at+6e5>Date.now()))return o;const{data:a,error:l}=yield E(t.fetch,"GET",`${t.url}/.well-known/jwks.json`,{headers:t.headers});if(l)throw l;if(!a.keys||0===a.keys.length)throw new Oe("JWKS is empty");if(t.jwks=a,t.jwks_cached_at=Date.now(),o=a.keys.find(d=>d.kid===n),!o)throw new Oe("No matching signing key found in JWKS");return o}).apply(this,arguments)}getClaims(e){var t=this;return(0,f.A)(function*(n,i={keys:[]}){try{let o=n;if(!o){const{data:S,error:D}=yield t.getSession();if(D||!S.session)return{data:null,error:D};o=S.session.access_token}const{header:a,payload:l,signature:d,raw:{header:c,payload:h}}=Qe(o);if(function Xr(s){if(!s)throw new Error("Missing exp claim");if(s<=Math.floor(Date.now()/1e3))throw new Error("JWT has expired")}(l.exp),!a.kid||"HS256"===a.alg||!("crypto"in globalThis)||!("subtle"in globalThis.crypto)){const{error:S}=yield t.getUser(o);if(S)throw S;return{data:{claims:l,header:a,signature:d},error:null}}const _=function Yr(s){switch(s){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}(a.alg),m=yield t.fetchJwk(a.kid,i),v=yield crypto.subtle.importKey("jwk",m,_,!0,["verify"]);if(!(yield crypto.subtle.verify(_,v,d,function Mr(s){const r=[];return function Et(s,r){for(let e=0;e<s.length;e+=1){let t=s.charCodeAt(e);if(t>55295&&t<=56319){const n=1024*(t-55296)&65535;t=65536+(s.charCodeAt(e+1)-56320&65535|n),e+=1}Ir(t,r)}}(s,e=>r.push(e)),new Uint8Array(r)}(`${c}.${h}`))))throw new Oe("Invalid JWT signature");return{data:{claims:l,header:a,signature:d},error:null}}catch(o){if(O(o))return{data:null,error:o};throw o}}).apply(this,arguments)}}return s.nextInstanceID=0,s})();class mn extends yn{constructor(r){super(r)}}class wn{constructor(r,e,t){var n,i,o;if(this.supabaseUrl=r,this.supabaseKey=e,!r)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const a=function kr(s){return s.endsWith("/")?s:s+"/"}(r),l=new URL(a);this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const d=`sb-${l.hostname.split(".")[0]}-auth-token`,h=function Ar(s,r){var e,t;const{db:n,auth:i,realtime:o,global:a}=s,{db:l,auth:d,realtime:c,global:h}=r,_={db:Object.assign(Object.assign({},l),n),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},c),o),global:Object.assign(Object.assign(Object.assign({},h),a),{headers:Object.assign(Object.assign({},null!==(e=null==h?void 0:h.headers)&&void 0!==e?e:{}),null!==(t=null==a?void 0:a.headers)&&void 0!==t?t:{})}),accessToken:()=>function(s,r,e,t){return new(e||(e=Promise))(function(i,o){function a(c){try{d(t.next(c))}catch(h){o(h)}}function l(c){try{d(t.throw(c))}catch(h){o(h)}}function d(c){c.done?i(c.value):function n(i){return i instanceof e?i:new e(function(o){o(i)})}(c.value).then(a,l)}d((t=t.apply(s,r||[])).next())})}(this,void 0,void 0,function*(){return""})};return s.accessToken?_.accessToken=s.accessToken:delete _.accessToken,_}(null!=t?t:{},{db:gr,realtime:_r,auth:Object.assign(Object.assign({},pr),{storageKey:d}),global:fr});this.storageKey=null!==(n=h.auth.storageKey)&&void 0!==n?n:"",this.headers=null!==(i=h.global.headers)&&void 0!==i?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(_,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(o=h.auth)&&void 0!==o?o:{},this.headers,h.global.fetch),this.fetch=br(e,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new L(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),h.accessToken||this._listenForAuthEvents()}get functions(){return new X(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}get storage(){return new dr(this.storageUrl.href,this.headers,this.fetch)}from(r){return this.rest.from(r)}schema(r){return this.rest.schema(r)}rpc(r,e={},t={}){return this.rest.rpc(r,e,t)}channel(r,e={config:{}}){return this.realtime.channel(r,e)}getChannels(){return this.realtime.getChannels()}removeChannel(r){return this.realtime.removeChannel(r)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var r,e;return function(s,r,e,t){return new(e||(e=Promise))(function(i,o){function a(c){try{d(t.next(c))}catch(h){o(h)}}function l(c){try{d(t.throw(c))}catch(h){o(h)}}function d(c){c.done?i(c.value):function n(i){return i instanceof e?i:new e(function(o){o(i)})}(c.value).then(a,l)}d((t=t.apply(s,r||[])).next())})}(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:t}=yield this.auth.getSession();return null!==(e=null===(r=t.session)||void 0===r?void 0:r.access_token)&&void 0!==e?e:null})}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:e,detectSessionInUrl:t,storage:n,storageKey:i,flowType:o,lock:a,debug:l},d,c){return new mn({url:this.authUrl.href,headers:Object.assign(Object.assign({},{Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`}),d),storageKey:i,autoRefreshToken:r,persistSession:e,detectSessionInUrl:t,storage:n,flowType:o,lock:a,debug:l,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(r){return new Zt(this.realtimeUrl.href,Object.assign(Object.assign({},r),{params:Object.assign({apikey:this.supabaseKey},null==r?void 0:r.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(r,e,t){"TOKEN_REFRESHED"!==r&&"SIGNED_IN"!==r||this.changedAccessToken===t?"SIGNED_OUT"===r&&(this.realtime.setAuth(),"STORAGE"==e&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=t}}var Mt=b(5312);let An=(()=>{var s;class r{constructor(){this.supabase=((s,r)=>new wn(s,r,{auth:{persistSession:!1,autoRefreshToken:!1,detectSessionInUrl:!1}}))(Mt.c.supabase.url,Mt.c.supabase.key)}get client(){return this.supabase}}return(s=r).\u0275fac=function(t){return new(t||s)},s.\u0275prov=u.jDH({token:s,factory:s.\u0275fac,providedIn:"root"}),r})();function Sn(s,r){if(1&s&&(u.j41(0,"ion-col",17)(1,"ion-card")(2,"ion-card-content")(3,"div",18),u.nrm(4,"ion-icon",19),u.k0s(),u.j41(5,"h3"),u.EFF(6),u.k0s(),u.j41(7,"p"),u.EFF(8),u.k0s()()()()),2&s){const e=r.$implicit;u.R7$(4),u.Y8G("name",e.icon),u.R7$(2),u.JRh(e.title),u.R7$(2),u.JRh(e.description)}}function On(s,r){if(1&s&&(u.j41(0,"ion-col",20)(1,"ion-card")(2,"ion-card-content")(3,"div",21),u.nrm(4,"ion-icon",19),u.k0s(),u.j41(5,"h3"),u.EFF(6),u.k0s(),u.j41(7,"p"),u.EFF(8),u.k0s()()()()),2&s){const e=r.$implicit;u.R7$(4),u.Y8G("name",e.icon),u.R7$(2),u.JRh(e.title),u.R7$(2),u.JRh(e.description)}}let Pn=(()=>{var s;class r{constructor(t,n,i){this.router=t,this.authService=n,this.supabaseService=i,this.howItWorks=[{icon:"people-outline",title:"Create or Join",description:"Start a new group or join an existing one"},{icon:"football-outline",title:"Make Predictions",description:"Predict match outcomes for each gameweek"},{icon:"trophy-outline",title:"Compete",description:"Earn points and climb the leaderboard"}],this.features=[{icon:"star-outline",title:"Multiple Groups",description:"Join different groups with friends or colleagues"},{icon:"cash-outline",title:"Prize Pools",description:"Optional entry fees and prize distributions"}],(0,B.a)({peopleOutline:T.wx_,personAddOutline:T.zsU,footballOutline:T.gMr,trophyOutline:T.NhD,starOutline:T.zV,cashOutline:T.A3w,logInOutline:T.oPd})}createGroup(){this.router.navigate(["/auth/signup"],{queryParams:{role:"group-admin",returnUrl:"/group-admin/groups",forceRole:"true"}})}joinGroup(){this.router.navigate(["/auth/signup"],{queryParams:{role:"player",returnUrl:"/player/join-group",forceRole:"true"}})}login(){this.router.navigate(["/auth/login"])}}return(s=r).\u0275fac=function(t){return new(t||s)(u.rXU(g.Ix),u.rXU(p.u),u.rXU(An))},s.\u0275cmp=u.VBU({type:s,selectors:[["app-welcome"]],standalone:!0,features:[u.aNF],decls:46,vars:2,consts:[[1,"logo-container"],["name","football-outline",1,"football-icon"],[1,"logo-text"],[1,"logo-sotd"],[1,"logo-subtitle"],["slot","end"],[3,"click"],["slot","start","name","log-in-outline"],[1,"ion-padding"],[1,"welcome-container"],[1,"options-container"],["name","people-outline"],["name","person-add-outline"],[1,"how-it-works"],["size","12","size-md","4",4,"ngFor","ngForOf"],[1,"features"],["size","12","size-md","6",4,"ngFor","ngForOf"],["size","12","size-md","4"],[1,"step-icon"],[3,"name"],["size","12","size-md","6"],[1,"feature-icon"]],template:function(t,n){1&t&&(u.j41(0,"ion-header")(1,"ion-toolbar")(2,"div",0),u.nrm(3,"ion-icon",1),u.j41(4,"div",2)(5,"span",3),u.EFF(6,"SOTD"),u.k0s(),u.j41(7,"span",4),u.EFF(8,"Predict 3"),u.k0s()()(),u.j41(9,"ion-buttons",5)(10,"ion-button",6),u.bIt("click",function(){return n.login()}),u.nrm(11,"ion-icon",7),u.EFF(12," Login "),u.k0s()()()(),u.j41(13,"ion-content",8)(14,"div",9)(15,"h1"),u.EFF(16,"Welcome to SOTD"),u.k0s(),u.j41(17,"p"),u.EFF(18,"Choose how you'd like to get started:"),u.k0s(),u.j41(19,"div",10)(20,"ion-card",6),u.bIt("click",function(){return n.createGroup()}),u.j41(21,"ion-card-header")(22,"ion-card-title"),u.nrm(23,"ion-icon",11),u.EFF(24," Create a Group "),u.k0s()(),u.j41(25,"ion-card-content"),u.EFF(26," Create your own prediction group and invite others to join. "),u.k0s()(),u.j41(27,"ion-card",6),u.bIt("click",function(){return n.joinGroup()}),u.j41(28,"ion-card-header")(29,"ion-card-title"),u.nrm(30,"ion-icon",12),u.EFF(31," Join a Group "),u.k0s()(),u.j41(32,"ion-card-content"),u.EFF(33," Join an existing prediction group using an invite code. "),u.k0s()()(),u.j41(34,"section",13)(35,"h2"),u.EFF(36,"How It Works"),u.k0s(),u.j41(37,"ion-grid")(38,"ion-row"),u.DNE(39,Sn,9,3,"ion-col",14),u.k0s()()(),u.j41(40,"section",15)(41,"h2"),u.EFF(42,"Features"),u.k0s(),u.j41(43,"ion-grid")(44,"ion-row"),u.DNE(45,On,9,3,"ion-col",16),u.k0s()()()()()),2&t&&(u.R7$(39),u.Y8G("ngForOf",n.howItWorks),u.R7$(6),u.Y8G("ngForOf",n.features))},dependencies:[P.eU,P.ai,P.W9,P.b_,P.ME,P.tN,P.I9,P.lO,P.ln,P.hU,P.iq,P.Jm,P.QW,j.pM],styles:["ion-toolbar[_ngcontent-%COMP%]{--padding-start: 0;--padding-end: 0}.logo-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px}.football-icon[_ngcontent-%COMP%]{font-size:24px;color:var(--ion-color-primary)}.logo-text[_ngcontent-%COMP%]{display:flex;flex-direction:column}.logo-sotd[_ngcontent-%COMP%]{font-size:18px;font-weight:600;line-height:1.2}.logo-subtitle[_ngcontent-%COMP%]{font-size:12px;color:var(--ion-color-medium);line-height:1}.welcome-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:20px;text-align:center}.welcome-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin-bottom:1rem;color:var(--ion-color-dark)}.welcome-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:var(--ion-color-dark);margin:3rem 0 2rem}.welcome-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1.1rem;color:var(--ion-color-medium);margin-bottom:2rem}.options-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;margin-bottom:3rem}.options-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{margin:0;cursor:pointer;transition:transform .2s ease}.options-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px)}.options-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;font-size:1.3rem}.options-container[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.5rem;color:var(--ion-color-primary)}.how-it-works[_ngcontent-%COMP%], .features[_ngcontent-%COMP%]{margin-bottom:3rem;text-align:center}.how-it-works[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .features[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.8rem;font-weight:600;margin-bottom:1.5rem;color:var(--ion-color-dark)}.how-it-works[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%], .features[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{height:100%;margin:0;text-align:center}.how-it-works[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   .step-icon[_ngcontent-%COMP%], .how-it-works[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%], .features[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   .step-icon[_ngcontent-%COMP%], .features[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   .feature-icon[_ngcontent-%COMP%]{font-size:2.5rem;color:var(--ion-color-primary);margin-bottom:1rem}.how-it-works[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%], .features[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600;margin-bottom:.5rem;color:var(--ion-color-dark)}.how-it-works[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .features[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:1rem;color:var(--ion-color-medium);margin:0}@media (max-width: 768px){.welcome-container[_ngcontent-%COMP%]{padding:16px}.welcome-container[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:1.8rem}.how-it-works[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .features[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.6rem}}"]}),r})()},5286:(G,w,b)=>{"use strict";b.r(w),b.d(w,{Headers:()=>u,Request:()=>g,Response:()=>p,default:()=>T,fetch:()=>B});var j=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")}();const B=j.fetch,T=j.fetch.bind(j),u=j.Headers,g=j.Request,p=j.Response},5958:function(G,w,b){"use strict";var P=b(9293).default,j=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(w,"__esModule",{value:!0});const B=j(b(5286)),T=j(b(4659));w.default=class u{constructor(p){this.shouldThrowOnError=!1,this.method=p.method,this.url=p.url,this.headers=p.headers,this.schema=p.schema,this.body=p.body,this.shouldThrowOnError=p.shouldThrowOnError,this.signal=p.signal,this.isMaybeSingle=p.isMaybeSingle,this.fetch=p.fetch?p.fetch:typeof fetch>"u"?B.default:fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(p,y){return this.headers=Object.assign({},this.headers),this.headers[p]=y,this}then(p,y){var k=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let R=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(function(){var C=P(function*(I){var z,X,ee;let L=null,J=null,we=null,le=I.status,ce=I.statusText;if(I.ok){if("HEAD"!==k.method){const ge=yield I.text();""===ge||(J="text/csv"===k.headers.Accept||k.headers.Accept&&k.headers.Accept.includes("application/vnd.pgrst.plan+text")?ge:JSON.parse(ge))}const fe=null===(z=k.headers.Prefer)||void 0===z?void 0:z.match(/count=(exact|planned|estimated)/),f=null===(X=I.headers.get("content-range"))||void 0===X?void 0:X.split("/");fe&&f&&f.length>1&&(we=parseInt(f[1])),k.isMaybeSingle&&"GET"===k.method&&Array.isArray(J)&&(J.length>1?(L={code:"PGRST116",details:`Results contain ${J.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},J=null,we=null,le=406,ce="Not Acceptable"):J=1===J.length?J[0]:null)}else{const fe=yield I.text();try{L=JSON.parse(fe),Array.isArray(L)&&404===I.status&&(J=[],L=null,le=200,ce="OK")}catch{404===I.status&&""===fe?(le=204,ce="No Content"):L={message:fe}}if(L&&k.isMaybeSingle&&!(null===(ee=null==L?void 0:L.details)||void 0===ee)&&ee.includes("0 rows")&&(L=null,le=200,ce="OK"),L&&k.shouldThrowOnError)throw new T.default(L)}return{error:L,data:J,count:we,status:le,statusText:ce}});return function(I){return C.apply(this,arguments)}}());return this.shouldThrowOnError||(R=R.catch(C=>{var I,z,X;return{error:{message:`${null!==(I=null==C?void 0:C.name)&&void 0!==I?I:"FetchError"}: ${null==C?void 0:C.message}`,details:`${null!==(z=null==C?void 0:C.stack)&&void 0!==z?z:""}`,hint:"",code:`${null!==(X=null==C?void 0:C.code)&&void 0!==X?X:""}`},data:null,count:null,status:0,statusText:""}})),R.then(p,y)}returns(){return this}overrideTypes(){return this}}},3242:function(G,w,b){"use strict";var P=this&&this.__importDefault||function(g){return g&&g.__esModule?g:{default:g}};Object.defineProperty(w,"__esModule",{value:!0});const j=P(b(8666)),B=P(b(3608)),T=b(3057);class u{constructor(p,{headers:y={},schema:k,fetch:$}={}){this.url=p,this.headers=Object.assign(Object.assign({},T.DEFAULT_HEADERS),y),this.schemaName=k,this.fetch=$}from(p){const y=new URL(`${this.url}/${p}`);return new j.default(y,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(p){return new u(this.url,{headers:this.headers,schema:p,fetch:this.fetch})}rpc(p,y={},{head:k=!1,get:$=!1,count:R}={}){let C;const I=new URL(`${this.url}/rpc/${p}`);let z;k||$?(C=k?"HEAD":"GET",Object.entries(y).filter(([ee,L])=>void 0!==L).map(([ee,L])=>[ee,Array.isArray(L)?`{${L.join(",")}}`:`${L}`]).forEach(([ee,L])=>{I.searchParams.append(ee,L)})):(C="POST",z=y);const X=Object.assign({},this.headers);return R&&(X.Prefer=`count=${R}`),new B.default({method:C,url:I,headers:X,schema:this.schemaName,body:z,fetch:this.fetch,allowEmpty:!1})}}w.default=u},4659:(G,w)=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0});class b extends Error{constructor(j){super(j.message),this.name="PostgrestError",this.details=j.details,this.hint=j.hint,this.code=j.code}}w.default=b},3608:function(G,w,b){"use strict";var P=this&&this.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(w,"__esModule",{value:!0});const j=P(b(3342));w.default=class B extends j.default{eq(u,g){return this.url.searchParams.append(u,`eq.${g}`),this}neq(u,g){return this.url.searchParams.append(u,`neq.${g}`),this}gt(u,g){return this.url.searchParams.append(u,`gt.${g}`),this}gte(u,g){return this.url.searchParams.append(u,`gte.${g}`),this}lt(u,g){return this.url.searchParams.append(u,`lt.${g}`),this}lte(u,g){return this.url.searchParams.append(u,`lte.${g}`),this}like(u,g){return this.url.searchParams.append(u,`like.${g}`),this}likeAllOf(u,g){return this.url.searchParams.append(u,`like(all).{${g.join(",")}}`),this}likeAnyOf(u,g){return this.url.searchParams.append(u,`like(any).{${g.join(",")}}`),this}ilike(u,g){return this.url.searchParams.append(u,`ilike.${g}`),this}ilikeAllOf(u,g){return this.url.searchParams.append(u,`ilike(all).{${g.join(",")}}`),this}ilikeAnyOf(u,g){return this.url.searchParams.append(u,`ilike(any).{${g.join(",")}}`),this}is(u,g){return this.url.searchParams.append(u,`is.${g}`),this}in(u,g){const p=Array.from(new Set(g)).map(y=>"string"==typeof y&&new RegExp("[,()]").test(y)?`"${y}"`:`${y}`).join(",");return this.url.searchParams.append(u,`in.(${p})`),this}contains(u,g){return"string"==typeof g?this.url.searchParams.append(u,`cs.${g}`):Array.isArray(g)?this.url.searchParams.append(u,`cs.{${g.join(",")}}`):this.url.searchParams.append(u,`cs.${JSON.stringify(g)}`),this}containedBy(u,g){return"string"==typeof g?this.url.searchParams.append(u,`cd.${g}`):Array.isArray(g)?this.url.searchParams.append(u,`cd.{${g.join(",")}}`):this.url.searchParams.append(u,`cd.${JSON.stringify(g)}`),this}rangeGt(u,g){return this.url.searchParams.append(u,`sr.${g}`),this}rangeGte(u,g){return this.url.searchParams.append(u,`nxl.${g}`),this}rangeLt(u,g){return this.url.searchParams.append(u,`sl.${g}`),this}rangeLte(u,g){return this.url.searchParams.append(u,`nxr.${g}`),this}rangeAdjacent(u,g){return this.url.searchParams.append(u,`adj.${g}`),this}overlaps(u,g){return this.url.searchParams.append(u,"string"==typeof g?`ov.${g}`:`ov.{${g.join(",")}}`),this}textSearch(u,g,{config:p,type:y}={}){let k="";return"plain"===y?k="pl":"phrase"===y?k="ph":"websearch"===y&&(k="w"),this.url.searchParams.append(u,`${k}fts${void 0===p?"":`(${p})`}.${g}`),this}match(u){return Object.entries(u).forEach(([g,p])=>{this.url.searchParams.append(g,`eq.${p}`)}),this}not(u,g,p){return this.url.searchParams.append(u,`not.${g}.${p}`),this}or(u,{foreignTable:g,referencedTable:p=g}={}){return this.url.searchParams.append(p?`${p}.or`:"or",`(${u})`),this}filter(u,g,p){return this.url.searchParams.append(u,`${g}.${p}`),this}}},8666:function(G,w,b){"use strict";var P=this&&this.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(w,"__esModule",{value:!0});const j=P(b(3608));w.default=class B{constructor(u,{headers:g={},schema:p,fetch:y}){this.url=u,this.headers=g,this.schema=p,this.fetch=y}select(u,{head:g=!1,count:p}={}){const y=g?"HEAD":"GET";let k=!1;const $=(null!=u?u:"*").split("").map(R=>/\s/.test(R)&&!k?"":('"'===R&&(k=!k),R)).join("");return this.url.searchParams.set("select",$),p&&(this.headers.Prefer=`count=${p}`),new j.default({method:y,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(u,{count:g,defaultToNull:p=!0}={}){const k=[];if(this.headers.Prefer&&k.push(this.headers.Prefer),g&&k.push(`count=${g}`),p||k.push("missing=default"),this.headers.Prefer=k.join(","),Array.isArray(u)){const $=u.reduce((R,C)=>R.concat(Object.keys(C)),[]);if($.length>0){const R=[...new Set($)].map(C=>`"${C}"`);this.url.searchParams.set("columns",R.join(","))}}return new j.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:this.fetch,allowEmpty:!1})}upsert(u,{onConflict:g,ignoreDuplicates:p=!1,count:y,defaultToNull:k=!0}={}){const R=[`resolution=${p?"ignore":"merge"}-duplicates`];if(void 0!==g&&this.url.searchParams.set("on_conflict",g),this.headers.Prefer&&R.push(this.headers.Prefer),y&&R.push(`count=${y}`),k||R.push("missing=default"),this.headers.Prefer=R.join(","),Array.isArray(u)){const C=u.reduce((I,z)=>I.concat(Object.keys(z)),[]);if(C.length>0){const I=[...new Set(C)].map(z=>`"${z}"`);this.url.searchParams.set("columns",I.join(","))}}return new j.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:this.fetch,allowEmpty:!1})}update(u,{count:g}={}){const y=[];return this.headers.Prefer&&y.push(this.headers.Prefer),g&&y.push(`count=${g}`),this.headers.Prefer=y.join(","),new j.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:u,fetch:this.fetch,allowEmpty:!1})}delete({count:u}={}){const p=[];return u&&p.push(`count=${u}`),this.headers.Prefer&&p.unshift(this.headers.Prefer),this.headers.Prefer=p.join(","),new j.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}},3342:function(G,w,b){"use strict";var P=this&&this.__importDefault||function(T){return T&&T.__esModule?T:{default:T}};Object.defineProperty(w,"__esModule",{value:!0});const j=P(b(5958));w.default=class B extends j.default{select(u){let g=!1;const p=(null!=u?u:"*").split("").map(y=>/\s/.test(y)&&!g?"":('"'===y&&(g=!g),y)).join("");return this.url.searchParams.set("select",p),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(u,{ascending:g=!0,nullsFirst:p,foreignTable:y,referencedTable:k=y}={}){const $=k?`${k}.order`:"order",R=this.url.searchParams.get($);return this.url.searchParams.set($,`${R?`${R},`:""}${u}.${g?"asc":"desc"}${void 0===p?"":p?".nullsfirst":".nullslast"}`),this}limit(u,{foreignTable:g,referencedTable:p=g}={}){return this.url.searchParams.set(typeof p>"u"?"limit":`${p}.limit`,`${u}`),this}range(u,g,{foreignTable:p,referencedTable:y=p}={}){const $=typeof y>"u"?"limit":`${y}.limit`;return this.url.searchParams.set(typeof y>"u"?"offset":`${y}.offset`,`${u}`),this.url.searchParams.set($,""+(g-u+1)),this}abortSignal(u){return this.signal=u,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.headers.Accept="GET"===this.method?"application/json":"application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:u=!1,verbose:g=!1,settings:p=!1,buffers:y=!1,wal:k=!1,format:$="text"}={}){var R;const C=[u?"analyze":null,g?"verbose":null,p?"settings":null,y?"buffers":null,k?"wal":null].filter(Boolean).join("|"),I=null!==(R=this.headers.Accept)&&void 0!==R?R:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${$}; for="${I}"; options=${C};`,this}rollback(){var u;return(null!==(u=this.headers.Prefer)&&void 0!==u?u:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}},3057:(G,w,b)=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.DEFAULT_HEADERS=void 0;const P=b(3056);w.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${P.version}`}},4060:function(G,w,b){"use strict";var P=this&&this.__importDefault||function(y){return y&&y.__esModule?y:{default:y}};Object.defineProperty(w,"__esModule",{value:!0}),w.PostgrestError=w.PostgrestBuilder=w.PostgrestTransformBuilder=w.PostgrestFilterBuilder=w.PostgrestQueryBuilder=w.PostgrestClient=void 0;const j=P(b(3242));w.PostgrestClient=j.default;const B=P(b(8666));w.PostgrestQueryBuilder=B.default;const T=P(b(3608));w.PostgrestFilterBuilder=T.default;const u=P(b(3342));w.PostgrestTransformBuilder=u.default;const g=P(b(5958));w.PostgrestBuilder=g.default;const p=P(b(4659));w.PostgrestError=p.default,w.default={PostgrestClient:j.default,PostgrestQueryBuilder:B.default,PostgrestFilterBuilder:T.default,PostgrestTransformBuilder:u.default,PostgrestBuilder:g.default,PostgrestError:p.default}},3056:(G,w)=>{"use strict";Object.defineProperty(w,"__esModule",{value:!0}),w.version=void 0,w.version="0.0.0-automated"},9293:G=>{function w(P,j,B,T,u,g,p){try{var y=P[g](p),k=y.value}catch($){return void B($)}y.done?j(k):Promise.resolve(k).then(T,u)}G.exports=function b(P){return function(){var j=this,B=arguments;return new Promise(function(T,u){var g=P.apply(j,B);function p(k){w(g,T,u,p,y,"next",k)}function y(k){w(g,T,u,p,y,"throw",k)}p(void 0)})}},G.exports.__esModule=!0,G.exports.default=G.exports}}]);