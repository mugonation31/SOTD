"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[875],{9875:(O,u,s)=>{s.r(u),s.d(u,{GroupLeaderboardPage:()=>F});var n=s(5050),g=s(177),m=s(5079),c=s(5873),e=s(4438),h=s(8199),b=s(4412);let v=(()=>{var a;class d{constructor(){this.seasonInfo=new b.t({currentGameweek:0,totalGameweeks:38,seasonStartDate:new Date("2024-08-10"),seasonEndDate:new Date("2025-05-19"),isSeasonStarted:!1,isSeasonEnded:!1}),this.updateSeasonStatus(),setInterval(()=>this.updateSeasonStatus(),36e5)}updateSeasonStatus(){const t=new Date,o=this.seasonInfo.value,l=t>=o.seasonStartDate,r=t>=o.seasonEndDate;let p=0;if(l&&!r){const P=(o.seasonEndDate.getTime()-o.seasonStartDate.getTime())/864e5,G=(t.getTime()-o.seasonStartDate.getTime())/864e5;p=Math.floor(G/P*o.totalGameweeks)+1}else r&&(p=o.totalGameweeks);this.seasonInfo.next({...o,currentGameweek:p,isSeasonStarted:l,isSeasonEnded:r})}getSeasonInfo(){return this.seasonInfo.asObservable()}getCurrentGameweek(){return this.seasonInfo.value.currentGameweek}isSeasonStarted(){return this.seasonInfo.value.isSeasonStarted}isSeasonEnded(){return this.seasonInfo.value.isSeasonEnded}}return(a=d).\u0275fac=function(t){return new(t||a)},a.\u0275prov=e.jDH({token:a,factory:a.\u0275fac,providedIn:"root"}),d})();var f=s(9699);function S(a,d){1&a&&(e.j41(0,"div",12),e.nrm(1,"ion-icon",13),e.j41(2,"span"),e.EFF(3,"Season not started - Players listed alphabetically"),e.k0s()())}function k(a,d){if(1&a&&(e.j41(0,"div",14)(1,"div",5),e.EFF(2),e.k0s(),e.j41(3,"div",6),e.EFF(4),e.k0s(),e.j41(5,"div",7),e.EFF(6),e.k0s(),e.j41(7,"div",8),e.EFF(8),e.k0s(),e.j41(9,"div",9),e.EFF(10),e.k0s()()),2&a){const i=d.$implicit;e.R7$(2),e.JRh(i.position),e.R7$(2),e.JRh(i.name),e.R7$(2),e.JRh(i.played),e.R7$(2),e.SpI("",i.jokerUsed,"/2"),e.R7$(2),e.JRh(i.totalPoints)}}let F=(()=>{var a;class d{constructor(t,o,l,r){this.route=t,this.seasonService=o,this.router=l,this.groupService=r,this.groupId="",this.groupName="",this.leaderboard=[],this.sortedLeaderboard=[],(0,m.a)({trophyOutline:c.NhD,arrowUpOutline:c.Tiw,arrowDownOutline:c.MVx,removeOutline:c.pqs,footballOutline:c.gMr,timeOutline:c.CVk,chevronBackOutline:c.fKZ})}ngOnInit(){this.route.params.subscribe(t=>{this.groupId=t.id,this.loadGroupData()}),this.groupsSubscription=this.groupService.groups$.subscribe(()=>{console.log("\u{1f504} Group Leaderboard: Received group update, reloading data..."),this.loadGroupData()})}ngOnDestroy(){this.groupsSubscription&&this.groupsSubscription.unsubscribe()}loadGroupData(){console.log("\u{1f4ca} Group Leaderboard: Loading data for group:",this.groupId);const o=this.groupService.getAllGroups().find(l=>l.id===this.groupId);if(o){this.groupName=o.name,console.log(`\u{1f4cb} Group "${o.name}": ${o.members.length} members`);const l=this.groupService.getGroupLeaderboard(this.groupId);this.leaderboard=l.map(r=>({position:r.position,name:r.name,played:r.played,jokerUsed:r.jokerUsed,totalPoints:r.totalPoints})),console.log("\u{1f4ca} Leaderboard entries:",this.leaderboard.length),this.sortLeaderboard()}else console.log("\u274c Group not found, navigating back"),this.router.navigate(["/group-admin/groups"])}sortLeaderboard(){this.sortedLeaderboard=this.seasonService.isSeasonStarted()?[...this.leaderboard].sort((t,o)=>o.totalPoints-t.totalPoints):[...this.leaderboard].sort((t,o)=>t.name.localeCompare(o.name)),this.sortedLeaderboard=this.sortedLeaderboard.map((t,o)=>({...t,position:o+1}))}goBack(){this.router.navigate(["/group-admin/groups"])}}return(a=d).\u0275fac=function(t){return new(t||a)(e.rXU(h.nX),e.rXU(v),e.rXU(h.Ix),e.rXU(f.B))},a.\u0275cmp=e.VBU({type:a,selectors:[["app-group-leaderboard"]],standalone:!0,features:[e.aNF],decls:26,vars:3,consts:[["slot","start"],["text","Groups","defaultHref","/group-admin/groups"],[1,"ion-padding"],["class","season-info",4,"ngIf"],[1,"table-header"],[1,"position-col"],[1,"name-col"],[1,"gameweek-col"],[1,"joker-col"],[1,"points-col"],[1,"table-body"],["class","table-row",4,"ngFor","ngForOf"],[1,"season-info"],["name","information-circle-outline"],[1,"table-row"]],template:function(t,o){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.nrm(3,"ion-back-button",1),e.k0s(),e.j41(4,"ion-title"),e.EFF(5),e.k0s()()(),e.j41(6,"ion-content",2)(7,"ion-card")(8,"ion-card-header")(9,"ion-card-title"),e.EFF(10,"Current Standings"),e.k0s(),e.DNE(11,S,4,0,"div",3),e.k0s(),e.j41(12,"ion-card-content")(13,"div",4)(14,"div",5),e.EFF(15,"Position"),e.k0s(),e.j41(16,"div",6),e.EFF(17,"Name"),e.k0s(),e.j41(18,"div",7),e.EFF(19,"Game Week"),e.k0s(),e.j41(20,"div",8),e.EFF(21,"Played Joker"),e.k0s(),e.j41(22,"div",9),e.EFF(23,"Points"),e.k0s()(),e.j41(24,"div",10),e.DNE(25,k,11,5,"div",11),e.k0s()()()()),2&t&&(e.R7$(5),e.SpI("",o.groupName," Leaderboard"),e.R7$(6),e.Y8G("ngIf",!o.seasonService.isSeasonStarted()),e.R7$(14),e.Y8G("ngForOf",o.sortedLeaderboard))},dependencies:[n.eU,n.ai,n.BC,n.W9,n.b_,n.ME,n.tN,n.I9,n.iq,n.el,n.QW,g.pM,g.bT],styles:[".table-header[_ngcontent-%COMP%]{display:grid;grid-template-columns:80px 1fr 100px 100px 80px;padding:12px 16px;background:var(--ion-color-light);font-weight:600;border-bottom:2px solid var(--ion-color-medium);gap:16px}.table-body[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:80px 1fr 100px 100px 80px;padding:12px 16px;border-bottom:1px solid var(--ion-color-light);gap:16px;align-items:center}.table-body[_ngcontent-%COMP%]   .table-row[_ngcontent-%COMP%]:hover{background:var(--ion-color-light-tint)}.position-col[_ngcontent-%COMP%]{font-weight:600}.name-col[_ngcontent-%COMP%]{font-weight:500}.gameweek-col[_ngcontent-%COMP%], .joker-col[_ngcontent-%COMP%]{text-align:center}.points-col[_ngcontent-%COMP%]{text-align:right;font-weight:600;color:var(--ion-color-primary)}.season-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-top:8px;color:var(--ion-color-medium);font-size:.9rem}.season-info[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.2rem}ion-back-button[_ngcontent-%COMP%]{display:block;--color: var(--ion-color-primary);--icon-font-size: 24px;--padding-start: 0}"]}),d})()}}]);