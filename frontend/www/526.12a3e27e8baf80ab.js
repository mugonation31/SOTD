"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[526],{526:(D,f,c)=>{c.r(f),c.d(f,{SuperAdminRegisterPage:()=>$});var m=c(467),v=c(177),s=c(4341),a=c(4738),h=c(7570),e=c(4438),P=c(8010),E=c(5423);const F=()=>["/super-admin/login"];function A(r,d){1&r&&(e.j41(0,"div",4),e.nrm(1,"ion-spinner",5),e.j41(2,"ion-text")(3,"p"),e.EFF(4,"Checking registration status..."),e.k0s()()())}function R(r,d){if(1&r&&(e.j41(0,"ion-note",28),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.getFieldError("firstName")," ")}}function k(r,d){if(1&r&&(e.j41(0,"ion-note",28),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.getFieldError("lastName")," ")}}function x(r,d){if(1&r&&(e.j41(0,"ion-note",28),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.getFieldError("username")," ")}}function S(r,d){if(1&r&&(e.j41(0,"ion-note",28),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.getFieldError("email")," ")}}function C(r,d){if(1&r&&(e.j41(0,"ion-note",28),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.getFieldError("password")," ")}}function b(r,d){if(1&r&&(e.j41(0,"ion-note",28),e.EFF(1),e.k0s()),2&r){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.getFieldError("confirmPassword")," ")}}function I(r,d){1&r&&(e.j41(0,"ion-note",28),e.EFF(1," Passwords do not match "),e.k0s())}function M(r,d){if(1&r){const t=e.RV6();e.j41(0,"ion-button",32),e.bIt("click",function(){e.eBV(t);const n=e.XpG(3);return e.Njj(n.retryConnection())}),e.EFF(1," Retry "),e.k0s()}}function y(r,d){if(1&r&&(e.j41(0,"div",29)(1,"ion-text",30)(2,"h4"),e.EFF(3),e.k0s(),e.j41(4,"p"),e.EFF(5),e.k0s()(),e.DNE(6,M,2,0,"ion-button",31),e.k0s()),2&r){const t=e.XpG(2);e.R7$(3),e.JRh(t.error.title),e.R7$(2),e.JRh(t.error.message),e.R7$(),e.Y8G("ngIf",t.error.retry)}}function O(r,d){1&r&&e.nrm(0,"ion-spinner",5)}function w(r,d){1&r&&(e.j41(0,"span"),e.EFF(1,"Create Super Admin Account"),e.k0s())}function j(r,d){1&r&&(e.j41(0,"span"),e.EFF(1,"Creating Account..."),e.k0s())}function N(r,d){if(1&r){const t=e.RV6();e.j41(0,"div")(1,"ion-card",6)(2,"ion-card-header")(3,"ion-card-title"),e.EFF(4,"Create Super Admin Account"),e.k0s(),e.j41(5,"ion-card-subtitle"),e.EFF(6,"One-time setup for Predict 3"),e.k0s()(),e.j41(7,"ion-card-content")(8,"div",7)(9,"ion-text",8)(10,"p"),e.EFF(11,"Set up the first Super Admin account to manage Predict 3's football prediction platform."),e.k0s()()(),e.j41(12,"form",9),e.bIt("ngSubmit",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.onSubmit())}),e.j41(13,"div",10)(14,"ion-text")(15,"h3"),e.EFF(16,"Personal Information"),e.k0s()(),e.j41(17,"ion-item")(18,"ion-label",11),e.EFF(19,"First Name"),e.k0s(),e.nrm(20,"ion-input",12),e.DNE(21,R,2,1,"ion-note",13),e.k0s(),e.j41(22,"ion-item")(23,"ion-label",11),e.EFF(24,"Last Name"),e.k0s(),e.nrm(25,"ion-input",14),e.DNE(26,k,2,1,"ion-note",13),e.k0s(),e.j41(27,"ion-item")(28,"ion-label",11),e.EFF(29,"Username"),e.k0s(),e.nrm(30,"ion-input",15),e.DNE(31,x,2,1,"ion-note",13),e.k0s()(),e.j41(32,"div",10)(33,"ion-text")(34,"h3"),e.EFF(35,"Account Information"),e.k0s()(),e.j41(36,"ion-item")(37,"ion-label",11),e.EFF(38,"Email"),e.k0s(),e.nrm(39,"ion-input",16),e.DNE(40,S,2,1,"ion-note",13),e.k0s(),e.j41(41,"ion-item")(42,"ion-label",11),e.EFF(43,"Password"),e.k0s(),e.nrm(44,"ion-input",17),e.DNE(45,C,2,1,"ion-note",13),e.k0s(),e.j41(46,"ion-item")(47,"ion-label",11),e.EFF(48,"Confirm Password"),e.k0s(),e.nrm(49,"ion-input",18),e.DNE(50,b,2,1,"ion-note",13)(51,I,2,0,"ion-note",13),e.k0s()(),e.j41(52,"div",10)(53,"ion-item"),e.nrm(54,"ion-checkbox",19),e.j41(55,"ion-label"),e.EFF(56," I agree to the terms and conditions for managing Predict 3 "),e.k0s()()(),e.DNE(57,y,7,3,"div",20),e.j41(58,"div",21)(59,"ion-button",22),e.DNE(60,O,1,0,"ion-spinner",23)(61,w,2,0,"span",2)(62,j,2,0,"span",2),e.k0s()(),e.j41(63,"div",24)(64,"ion-text",8)(65,"small"),e.EFF(66,"Development Mode - Using Dummy Data"),e.k0s()(),e.j41(67,"ion-button",25),e.bIt("click",function(){e.eBV(t);const n=e.XpG();return e.Njj(n.resetRegistrationState())}),e.EFF(68," Reset Registration State "),e.k0s()(),e.j41(69,"div",26)(70,"ion-text",8)(71,"p"),e.EFF(72,"Already have a super admin account? "),e.j41(73,"a",27),e.EFF(74,"Login here"),e.k0s()()()()()()()()}if(2&r){const t=e.XpG();e.R7$(12),e.Y8G("formGroup",t.registrationForm),e.R7$(8),e.AVh("ion-invalid",t.isFieldInvalid("firstName")),e.R7$(),e.Y8G("ngIf",t.isFieldInvalid("firstName")),e.R7$(4),e.AVh("ion-invalid",t.isFieldInvalid("lastName")),e.R7$(),e.Y8G("ngIf",t.isFieldInvalid("lastName")),e.R7$(4),e.AVh("ion-invalid",t.isFieldInvalid("username")),e.R7$(),e.Y8G("ngIf",t.isFieldInvalid("username")),e.R7$(8),e.AVh("ion-invalid",t.isFieldInvalid("email")),e.R7$(),e.Y8G("ngIf",t.isFieldInvalid("email")),e.R7$(4),e.AVh("ion-invalid",t.isFieldInvalid("password")),e.R7$(),e.Y8G("ngIf",t.isFieldInvalid("password")),e.R7$(4),e.AVh("ion-invalid",t.isFieldInvalid("confirmPassword")||(null==t.registrationForm.errors?null:t.registrationForm.errors.passwordMismatch)),e.R7$(),e.Y8G("ngIf",t.isFieldInvalid("confirmPassword")),e.R7$(),e.Y8G("ngIf",null==t.registrationForm.errors?null:t.registrationForm.errors.passwordMismatch),e.R7$(6),e.Y8G("ngIf",t.error),e.R7$(2),e.Y8G("disabled",t.registrationForm.invalid||t.isLoading),e.R7$(),e.Y8G("ngIf",t.isLoading),e.R7$(),e.Y8G("ngIf",!t.isLoading),e.R7$(),e.Y8G("ngIf",t.isLoading),e.R7$(11),e.Y8G("routerLink",e.lJ4(26,F))}}function T(r,d){1&r&&(e.j41(0,"div",33)(1,"ion-card",6)(2,"ion-card-header")(3,"ion-card-title"),e.EFF(4,"Super Admin Already Exists"),e.k0s()(),e.j41(5,"ion-card-content")(6,"ion-text")(7,"p"),e.EFF(8,"A Super Admin account has already been created for Predict 3."),e.k0s(),e.j41(9,"p"),e.EFF(10,"Please login with your existing credentials instead."),e.k0s()(),e.j41(11,"div",21)(12,"ion-button",34),e.EFF(13," Go to Login "),e.k0s()()()()()),2&r&&(e.R7$(12),e.Y8G("routerLink",e.lJ4(1,F)))}let $=(()=>{var r;class d{constructor(i,n,o,l){this.fb=i,this.authService=n,this.toastService=o,this.router=l,this.isLoading=!1,this.isCheckingExistingAdmin=!0,this.superAdminExists=!1,this.registrationForm=this.fb.group({firstName:["",[s.k0.required,s.k0.minLength(2)]],lastName:["",[s.k0.required,s.k0.minLength(2)]],username:["",[s.k0.required,s.k0.minLength(3)]],email:["",[s.k0.required,s.k0.email]],password:["",[s.k0.required,s.k0.minLength(8)]],confirmPassword:["",[s.k0.required]],acceptedTerms:[!1,[s.k0.requiredTrue]]},{validators:this.passwordMatchValidator})}ngOnInit(){var i=this;return(0,m.A)(function*(){yield i.checkExistingSuperAdmin()})()}checkExistingSuperAdmin(){var i=this;return(0,m.A)(function*(){try{i.isCheckingExistingAdmin=!0;const n=localStorage.getItem("superAdminCreated");i.superAdminExists="true"===n,i.superAdminExists?(console.log("\u2139\ufe0f Super admin already exists (dummy data), redirecting to login"),i.toastService.showToast("Super admin already exists. Please login instead.","warning"),setTimeout(()=>{i.router.navigate(["/super-admin/login"])},2e3)):console.log("\u2705 No super admin found, registration available")}catch(n){console.error("Error checking super admin existence:",n),i.error={title:"Connection Error",message:"Unable to check registration status. Please try again.",retry:!0}}finally{i.isCheckingExistingAdmin=!1}})()}passwordMatchValidator(i){var n,o;return(null===(n=i.get("password"))||void 0===n?void 0:n.value)===(null===(o=i.get("confirmPassword"))||void 0===o?void 0:o.value)?null:{passwordMismatch:!0}}onSubmit(){var i=this;return(0,m.A)(function*(){if(i.registrationForm.valid&&!i.superAdminExists){i.isLoading=!0,i.error=void 0;try{const n=i.registrationForm.value;console.log("\u{1f680} Starting Super Admin Registration for Predict 3..."),i.authService.signup({email:n.email,password:n.password,username:n.username,firstName:n.firstName,lastName:n.lastName,role:"super-admin"}).subscribe({next:l=>{console.log("\u2705 Super Admin Registration successful:",l),localStorage.setItem("superAdminCreated","true"),i.toastService.showToast("Welcome to Predict 3! Super Admin account created successfully.","success"),console.log("\u{1f504} Auto-logging in super admin..."),i.autoLoginAfterRegistration(n.email,n.password)},error:l=>{console.error("\u274c Super Admin Registration failed:",l),i.error={title:"Registration Failed",message:i.getErrorMessage(l),retry:!0},i.isLoading=!1}})}catch(n){console.error("\u274c Super Admin Registration failed:",n),i.error={title:"Registration Failed",message:i.getErrorMessage(n),retry:!0},i.isLoading=!1}}})()}autoLoginAfterRegistration(i,n){var o=this;return(0,m.A)(function*(){try{var l,g,u;const p={email:i,password:n,securityQuestion:"N/A",securityAnswer:"N/A"};localStorage.setItem(`pendingRole_${i}`,"super-admin"),localStorage.setItem(`pendingUsername_${i}`,null===(l=o.registrationForm.get("username"))||void 0===l?void 0:l.value),localStorage.setItem(`pendingFirstName_${i}`,null===(g=o.registrationForm.get("firstName"))||void 0===g?void 0:g.value),localStorage.setItem(`pendingLastName_${i}`,null===(u=o.registrationForm.get("lastName"))||void 0===u?void 0:u.value),o.authService.login(p).subscribe({next:_=>{console.log("\u2705 Auto-login successful:",_),o.router.navigate(["/super-admin/dashboard"]),o.toastService.showToast("Welcome to Predict 3! You are now logged in as Super Admin.","success")},error:_=>{console.error("\u274c Auto-login failed:",_),o.toastService.showToast("Registration successful! Please login to continue.","success"),o.router.navigate(["/super-admin/login"])}})}catch(p){console.error("\u274c Auto-login error:",p),o.toastService.showToast("Registration successful! Please login to continue.","success"),o.router.navigate(["/super-admin/login"])}})()}getErrorMessage(i){var n,o,l;return null!=i&&null!==(n=i.message)&&void 0!==n&&n.includes("already registered")?"This email is already registered. Please use a different email or login instead.":null!=i&&null!==(o=i.message)&&void 0!==o&&o.includes("invalid email")?"Please enter a valid email address.":null!=i&&null!==(l=i.message)&&void 0!==l&&l.includes("weak password")?"Password must be at least 8 characters long and contain uppercase, lowercase, and numbers.":(null==i?void 0:i.message)||"An unexpected error occurred. Please try again."}retryConnection(){this.error=void 0,this.checkExistingSuperAdmin()}isFieldInvalid(i){const n=this.registrationForm.get(i);return!(!n||!n.invalid||!n.dirty&&!n.touched)}getFieldError(i){const n=this.registrationForm.get(i);if(!n||!n.errors)return"";const o=n.errors;return o.required?`${this.getFieldLabel(i)} is required.`:o.email?"Please enter a valid email address.":o.minlength?`${this.getFieldLabel(i)} must be at least ${o.minlength.requiredLength} characters.`:o.passwordMismatch?"Passwords do not match.":"Invalid input."}getFieldLabel(i){return{firstName:"First Name",lastName:"Last Name",username:"Username",email:"Email",password:"Password",confirmPassword:"Confirm Password"}[i]||i}resetRegistrationState(){localStorage.removeItem("superAdminCreated"),console.log("\u{1f504} Registration state reset - super admin can be created again"),this.checkExistingSuperAdmin()}}return(r=d).\u0275fac=function(i){return new(i||r)(e.rXU(s.ok),e.rXU(P.u),e.rXU(E.f),e.rXU(h.Ix))},r.\u0275cmp=e.VBU({type:r,selectors:[["app-super-admin-register"]],standalone:!0,features:[e.aNF],decls:8,vars:3,consts:[[1,"ion-padding"],["class","loading-container",4,"ngIf"],[4,"ngIf"],["class","already-exists-container",4,"ngIf"],[1,"loading-container"],["name","crescent"],[1,"auth-card"],[1,"auth-header"],["color","medium"],[3,"ngSubmit","formGroup"],[1,"form-section"],["position","stacked"],["type","text","formControlName","firstName","placeholder","Enter your first name"],["slot","error",4,"ngIf"],["type","text","formControlName","lastName","placeholder","Enter your last name"],["type","text","formControlName","username","placeholder","Choose a username"],["type","email","formControlName","email","placeholder","Enter your email"],["type","password","formControlName","password","placeholder","Create a secure password"],["type","password","formControlName","confirmPassword","placeholder","Confirm your password"],["formControlName","acceptedTerms","slot","start"],["class","error-container",4,"ngIf"],[1,"auth-actions"],["expand","block","type","submit",3,"disabled"],["name","crescent",4,"ngIf"],[1,"debug-section",2,"margin-top","20px","padding","10px","border-top","1px solid var(--ion-color-light)"],["fill","outline","color","warning","size","small",3,"click"],[1,"auth-footer"],[3,"routerLink"],["slot","error"],[1,"error-container"],["color","danger"],["fill","outline","color","danger",3,"click",4,"ngIf"],["fill","outline","color","danger",3,"click"],[1,"already-exists-container"],["expand","block",3,"routerLink"]],template:function(i,n){1&i&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Super Admin Registration - Predict 3"),e.k0s()()(),e.j41(4,"ion-content",0),e.DNE(5,A,5,0,"div",1)(6,N,75,27,"div",2)(7,T,14,2,"div",3),e.k0s()),2&i&&(e.R7$(5),e.Y8G("ngIf",n.isCheckingExistingAdmin),e.R7$(),e.Y8G("ngIf",!n.isCheckingExistingAdmin&&!n.superAdminExists),e.R7$(),e.Y8G("ngIf",!n.isCheckingExistingAdmin&&n.superAdminExists))},dependencies:[v.MD,v.bT,s.X1,s.qT,s.BC,s.cb,s.j4,s.JD,h.Wk,a.eU,a.ai,a.BC,a.W9,a.uz,a.he,a.$w,a.Jm,a.b_,a.ME,a.tN,a.HW,a.I9,a.IO,a.JI,a.eY,a.w2],styles:["[_nghost-%COMP%]   ion-content[_ngcontent-%COMP%]{--background: #f5f5f5}[_nghost-%COMP%]   ion-card[_ngcontent-%COMP%]{max-width:600px;margin:2rem auto;border-radius:8px;box-shadow:0 4px 6px #0000001a}[_nghost-%COMP%]   ion-card-header[_ngcontent-%COMP%]{background:var(--ion-color-primary);color:var(--ion-color-primary-contrast);padding:1.5rem}[_nghost-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:var(--ion-color-primary-contrast)}[_nghost-%COMP%]   ion-card-header[_ngcontent-%COMP%]   ion-card-subtitle[_ngcontent-%COMP%]{color:var(--ion-color-primary-contrast);opacity:.8;margin-top:.5rem}[_nghost-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:2rem}[_nghost-%COMP%]   ion-item-group[_ngcontent-%COMP%]{margin-bottom:2rem}[_nghost-%COMP%]   ion-item-divider[_ngcontent-%COMP%]{margin-bottom:1rem;--background: transparent;font-weight:600;font-size:1.1rem;border-bottom:2px solid var(--ion-color-primary);color:var(--ion-color-primary)}[_nghost-%COMP%]   ion-item[_ngcontent-%COMP%]{--padding-start: 0;--inner-padding-end: 0;margin-bottom:1rem}[_nghost-%COMP%]   ion-checkbox[_ngcontent-%COMP%]{margin-right:1rem}[_nghost-%COMP%]   .security-question-group[_ngcontent-%COMP%]{margin-bottom:1.5rem;padding:1rem;background:#f8f9fa;border-radius:4px}[_nghost-%COMP%]   ion-button[type=submit][_ngcontent-%COMP%]{margin:2rem 0 1rem;height:48px;font-size:1.1rem;--border-radius: 8px}[_nghost-%COMP%]   ion-note[_ngcontent-%COMP%]{font-size:.85rem;color:var(--ion-color-medium);margin-top:.5rem}@media (max-width: 768px){[_nghost-%COMP%]   ion-card[_ngcontent-%COMP%]{margin:1rem;width:auto}[_nghost-%COMP%]   ion-card-content[_ngcontent-%COMP%]{padding:1rem}}"]}),d})()}}]);